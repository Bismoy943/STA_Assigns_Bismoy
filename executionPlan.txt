25/03/24 21:46:20 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
== Parsed Logical Plan ==
'Distinct
+- 'Project ['SL.SUBL_ID AS SUBL_ID#0, 'SL.SUBL_ID_TYPE AS SUBL_ID_TYPE#1, CASE WHEN (('substring('ACCT.ACCT_ID, -2) = +C) && ('SL.GL_AMT_TYPE = BANL)) THEN 'ACCT.ACCT_ID WHEN (('substring('ACCT.ACCT_ID, -2) = +I) && ('SL.GL_AMT_TYPE = IPIA)) THEN 'ACCT.ACCT_ID WHEN (('substring('ACCT.ACCT_ID, -2) = +R) && ('SL.GL_AMT_TYPE = RPIP)) THEN 'ACCT.ACCT_ID ELSE 'ACCT.ACCT_ID END AS TRAN_REF_NO#2, CASE WHEN isnotnull('ACCT.ACCT_ID) THEN ACCT ELSE NA END AS CAT_CD#3, 'SL.UNIQ_ID AS UNIQ_ID#4, 'SL.SRC_SYS AS SRC_SYS#5, 'SL.CTRY_CD AS CTRY_CD#6, null AS INSTR_ID#7, null AS PTFOL_ID#8, 'PRTY_SP_TPCLIENT.PRTY_ID AS PRTY_ID#9, 'PRTY_MP_TPCLIENT.PRTY_ID AS PRTY_MAIN_ID#10, 'PRTY_SP_RISKPRTY.PRTY_ID AS RISK_PRTY_ID#11, null AS BKR_ID#12, null AS CLRG_BKR_ID#13, 'ACCT.CP_ID AS CP_ID#14, 'ACCT.RISK_PRTY_ID AS SRC_RISK_PRTY_ID#15, null AS SRC_BKR_ID#16, null AS SRC_CLRG_BKR_ID#17, null AS ACCT_STS_CD#18, 'ACCT.LIFCYCL_STS_CD AS LIFCYCL_STS_CD#19, 'ACCT.LOCAL_PRD_CD AS LOCAL_PRD_CD#20, 'ACCT.STD_PRD_CD AS STD_PRD_CD#21, 'ACCT.BK_CD AS BK_CD#22, 'ACCT.TP_ENT_NM AS TP_ENT_NM#23, ... 117 more fields]
   +- 'Filter (((('SL.ODS_VAL = 2024-08-31) && ('SL.TP_SYS_VAL = OTP)) && ('SL.SRC_SYS = OTP)) && ((NOT 'SL.GL_ACCT_CD LIKE 9% && isnull('PGC.CHRT_FLD_ID)) && ('SL.PROCESS_ID_VAL = SUB_LDGR-OTP-FPSLBS)))
      +- 'Join LeftOuter, (((('PRTYMST2.PRTY_ID = 'ACCT.RISK_PRTY_ID) && ('PRTYMST2.ODS_VAL = 'SL.ODS_VAL)) && ('PRTYMST2.CTRY_CD = 'SL.CTRY_CD)) && (('PRTYMST2.PROCESS_ID_VAL = PRTY-OTP-CUST) && ('PRTYMST2.ODS_VAL = 2024-08-31)))
         :- 'Join LeftOuter, (((('PRTYMST1.PRTY_ID = 'ACCT.CP_ID) && ('PRTYMST1.ODS_VAL = 'SL.ODS_VAL)) && ('PRTYMST1.CTRY_CD = 'SL.CTRY_CD)) && (('PRTYMST1.PROCESS_ID_VAL = PRTY-OTP-CUST) && ('PRTYMST1.ODS_VAL = 2024-08-31)))
         :  :- 'Join LeftOuter, (((('PRTY_SP_TPCLIENT.PRTY_ID = 'PER.PRTY_ID) && ('SCBENTITYXLATE.SCI_ENTITY_CODE = 'PER.BKG_ORG_VAL)) && (('PRTY_SP_TPCLIENT.ODS_VAL = 'PER.ODS_VAL) && ('PER.STAFF_BIZ_TYPE = FAM))) && ((('PER.PRNC_FAM_FLG = Y) && isnotnull('PER.EMP_CD)) && (('PER.PROCESS_ID_VAL = PRTY_EMP_RLTD-SCI-LSPEMPMAP) && ('PER.ODS_VAL = 2024-08-31))))
         :  :  :- 'Join LeftOuter, (('SL.GL_ACCT_CD = 'GL.ACCT) && ('GL.ODS = 2024-08-31))
         :  :  :  :- 'Join LeftOuter, ((('SL.SRC_SYS = 'JRNLSRC.DERIVED_ADM_TP_SOURCE) && ('JRNLSRC.ODS = 'SL.ODS_VAL)) && ('JRNLSRC.ODS = 2024-08-31))
         :  :  :  :  :- 'Join LeftOuter, (((('SL.GL_ACCT_CD = 'ACCTCLASS.PSGLACCOUNTFROM) && ('SL.GL_BIZ_UNIT_CD = 'ACCTCLASS.PSGLBU)) && ('SL.GL_PRD_CD = 'ACCTCLASS.PSGLPRODUCTFROM)) && ((('SL.GL_DEPT_CD = 'ACCTCLASS.PSGLDEPTFROM) && ('ACCTCLASS.ODS = 'SL.ODS_VAL)) && ('ACCTCLASS.ODS = 2024-08-31)))
         :  :  :  :  :  :- 'Join LeftOuter, (('SL.GL_ACCT_CD = 'PGC.CHRT_FLD_ID) && ('PGC.ODS_VAL = 'SL.ODS_VAL))
         :  :  :  :  :  :  :- 'Join LeftOuter, (((('SL.GL_CUST_CLAS_CD = 'COA.CHRT_FLD_ID) && ('COA.ODS_VAL = 'SL.ODS_VAL)) && ('COA.SRC_SYS = RDM)) && (('COA.CHRT_FLD_TYPE_CD = CustomerClass) && ('COA.ODS_VAL = 2024-08-31)))
         :  :  :  :  :  :  :  :- 'Join LeftOuter, ((((CASE WHEN ('length('ACCT.ACCT_REF_ID) = 12) THEN 'substring('ACCT.ACCT_REF_ID, 1, 3) ELSE 'substring('ACCT.ACCT_REF_ID, 3, 3) END = 'scbentityxlate.branch_code) && ('SL.CTRY_CD = 'scbentityxlate.country_code)) && ('SL.ODS = 'scbentityxlate.ODS)) && (('scbentityxlate.ODS = 2024-08-31) && ('tp_system = OTP)))
         :  :  :  :  :  :  :  :  :- 'Join LeftOuter, (((('PRTY_SP_RISKPRTY.PRTY_ID = 'PRL_RISKPRTY.PRTY_ID) && ('PRTY_SP_RISKPRTY.ODS_VAL = 'PRL_RISKPRTY.ODS_VAL)) && ('PRTY_SP_RISKPRTY.SRC_SYS = SCI)) && ((('PRTY_SP_RISKPRTY.PRTY_CAT_CD = SubProfile) && ('PRTY_SP_RISKPRTY.ODS_VAL = 2024-08-31)) && ('PRTY_SP_RISKPRTY.PROCESS_ID_VAL = PRTY-SCI-SUBPROF)))
         :  :  :  :  :  :  :  :  :  :- 'Join LeftOuter, (((('PRTY_MP_RISKPRTY.PRTY_ID = 'PRL_RISKPRTY.PRTY_RL_ID) && ('PRTY_MP_RISKPRTY.ODS_VAL = 'PRL_RISKPRTY.ODS_VAL)) && ('PRTY_MP_RISKPRTY.SRC_SYS = SCI)) && ((('PRTY_MP_RISKPRTY.PRTY_CAT_CD = MainProfile) && ('PRTY_MP_RISKPRTY.ODS_VAL = 2024-08-31)) && ('PRTY_MP_RISKPRTY.PROCESS_ID_VAL = PRTY-SCI-MAINPROF)))
         :  :  :  :  :  :  :  :  :  :  :- 'Join LeftOuter, (((('PRTY_SP_TPCLIENT.PRTY_ID = 'PRL_TPCLIENT.PRTY_ID) && ('PRTY_SP_TPCLIENT.ODS_VAL = 'PRL_TPCLIENT.ODS_VAL)) && ('PRTY_SP_TPCLIENT.SRC_SYS = SCI)) && ((('PRTY_SP_TPCLIENT.PRTY_CAT_CD = SubProfile) && ('PRTY_SP_TPCLIENT.ODS_VAL = 2024-08-31)) && ('PRTY_SP_TPCLIENT.PROCESS_ID_VAL = PRTY-SCI-SUBPROF)))
         :  :  :  :  :  :  :  :  :  :  :  :- 'Join LeftOuter, (((('PRTY_MP_TPCLIENT.PRTY_ID = 'PRL_TPCLIENT.PRTY_RL_ID) && ('PRTY_MP_TPCLIENT.ODS_VAL = 'PRL_TPCLIENT.ODS_VAL)) && ('PRTY_MP_TPCLIENT.SRC_SYS = SCI)) && ((('PRTY_MP_TPCLIENT.PRTY_CAT_CD = MainProfile) && ('PRTY_MP_TPCLIENT.ODS_VAL = 2024-08-31)) && ('PRTY_MP_TPCLIENT.PROCESS_ID_VAL = PRTY-SCI-MAINPROF)))
         :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join LeftOuter, (((('PRL_RISKPRTY.PRTY_ID = 'PARL_RISKPRTY.PRTY_ID) && ('PRL_RISKPRTY.ODS_VAL = 'PARL_RISKPRTY.ODS_VAL)) && ('PRL_RISKPRTY.SRC_SYS = SCI)) && ((('PRL_RISKPRTY.RL_TYPE_CD = SubProfileToMainProfile) && ('PRL_RISKPRTY.ODS_VAL = 2024-08-31)) && ('PRL_RISKPRTY.PROCESS_ID_VAL = PRTY_RLTD-SCI-SUBPROF)))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join LeftOuter, (((('PRL_TPCLIENT.PRTY_ID = 'PARL_TPCLIENT.PRTY_ID) && ('PRL_TPCLIENT.ODS_VAL = 'PARL_TPCLIENT.ODS_VAL)) && ('PRL_TPCLIENT.SRC_SYS = SCI)) && ((('PRL_TPCLIENT.RL_TYPE_CD = SubProfileToMainProfile) && ('PRL_TPCLIENT.ODS_VAL = 2024-08-31)) && ('PRL_TPCLIENT.PROCESS_ID_VAL = PRTY_RLTD-SCI-SUBPROF)))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join LeftOuter, (((('PARL_RISKPRTY.ACCT_ID = 'ACCT.ACCT_ID) && ('PARL_RISKPRTY.ODS_VAL = 'ACCT.ODS_VAL)) && (('PARL_RISKPRTY.TP_SYS_VAL = 'ACCT.TP_SYS_VAL) && ('PARL_RISKPRTY.SRC_SYS = 'ACCT.SRC_SYS))) && ((('PARL_RISKPRTY.country_val = 'ACCT.country_val) && ('PARL_RISKPRTY.RL_TYPE_CD = RiskPartytoSubprofile)) && (('PARL_RISKPRTY.ODS_VAL = 2024-08-31) && ('PARL_RISKPRTY.PROCESS_ID_VAL = PRTY_ACCT_RLTD-OTP-RISKPRTY_FPSL))))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join LeftOuter, (((('PARL_TPCLIENT.ACCT_ID = 'ACCT.ACCT_ID) && ('PARL_TPCLIENT.ODS_VAL = 'ACCT.ODS_VAL)) && (('PARL_TPCLIENT.TP_SYS_VAL = 'ACCT.TP_SYS_VAL) && ('PARL_TPCLIENT.SRC_SYS = 'ACCT.SRC_SYS))) && ((('PARL_TPCLIENT.country_val = 'ACCT.country_val) && ('PARL_TPCLIENT.RL_TYPE_CD = TPCustomertoSubprofile)) && (('PARL_TPCLIENT.ODS_VAL = 2024-08-31) && ('PARL_TPCLIENT.PROCESS_ID_VAL = PRTY_ACCT_RLTD-OTP-TPCUST_FPSL))))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join LeftOuter, (((('ACCT.ACCT_ID = 'SLACCT_RL.ACCT_ID) && ('ACCT.country_val = 'SLACCT_RL.country_val)) && (('ACCT.ODS_VAL = 'SLACCT_RL.ODS_VAL) && ('ACCT.TP_SYS_VAL = 'SLACCT_RL.TP_SYS_VAL))) && ((('ACCT.SRC_SYS = OTP) && ('ACCT.PROCESS_ID_VAL = ACCT-OTP-TRDSTATIC)) && ('ACCT.ODS_VAL = 2024-08-31)))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'Join LeftOuter, (((('SLACCT_RL.SUBL_ID = 'SL.SUBL_ID) && ('SLACCT_RL.TP_SYS_VAL = OTP)) && (('SLACCT_RL.SRC_SYS = OTP) && ('SLACCT_RL.ODS_VAL = 'SL.ODS_VAL))) && ((('SLACCT_RL.country_val = 'SL.country_val) && ('SLACCT_RL.RL_TYPE_CD = SubLedgerToAccount)) && (('SLACCT_RL.PROCESS_ID_VAL = SUB_LDGR_ACCT_RLTD-OTP-FPSLBS) && ('SLACCT_RL.ODS_VAL = 2024-08-31))))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- 'SubqueryAlias SL
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'UnresolvedRelation `fdp_daas_uat`.`SUB_LDGR`
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias SLACCT_RL
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`SUB_LDGR_ACCT_RLTD`
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias ACCT
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`ACCT`
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias PARL_TPCLIENT
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY_ACCT_RLTD`
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias PARL_RISKPRTY
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY_ACCT_RLTD`
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias PRL_TPCLIENT
         :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY_RLTD`
         :  :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias PRL_RISKPRTY
         :  :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY_RLTD`
         :  :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias PRTY_MP_TPCLIENT
         :  :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY`
         :  :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias PRTY_SP_TPCLIENT
         :  :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY`
         :  :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias PRTY_MP_RISKPRTY
         :  :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY`
         :  :  :  :  :  :  :  :  :  +- 'SubqueryAlias PRTY_SP_RISKPRTY
         :  :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY`
         :  :  :  :  :  :  :  :  +- 'SubqueryAlias scbentityxlate
         :  :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_mfu_staging_dev`.`m_scb_entity_xlate`
         :  :  :  :  :  :  :  +- 'SubqueryAlias COA
         :  :  :  :  :  :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`CHRT_OF_ACCT`
         :  :  :  :  :  :  +- 'SubqueryAlias PGC
         :  :  :  :  :  :     +- 'Distinct
         :  :  :  :  :  :        +- 'Project ['CHRT_FLD_ID, 'DESC, 'CHRT_FLD_CAT_CD, 'SRC_SYS, 'CHRT_FLD_TYPE_CD, 'PGC_IFRSS_SCH, 'PGC_IFRSS_SCH_DESC, 'PGC_GRP_NONGRP, 'PGC_MR_SCH_REF, 'ODS_VAL]
         :  :  :  :  :  :           +- 'Filter ((('PGC.ODS_VAL = 2024-08-31) && 'CHRT_FLD_CAT_CD LIKE %P/L%) && (('SRC_SYS = RDM) && ('CHRT_FLD_TYPE_CD = Account)))
         :  :  :  :  :  :              +- 'SubqueryAlias PGC
         :  :  :  :  :  :                 +- 'UnresolvedRelation `fdp_daas_uat`.`CHRT_OF_ACCT`
         :  :  :  :  :  +- 'SubqueryAlias ACCTCLASS
         :  :  :  :  :     +- 'UnresolvedRelation `FDP_MFU_STAGING_dev`.`M_IFRS9_ACCT_CLASS_XLATE`
         :  :  :  :  +- 'SubqueryAlias JRNLSRC
         :  :  :  :     +- 'Distinct
         :  :  :  :        +- 'Project ['derived_adm_tp_source, 'derived_adm_jrnl_src, 'ods]
         :  :  :  :           +- 'Filter ('ODS = 2024-08-31)
         :  :  :  :              +- 'UnresolvedRelation `FDP_MFU_STAGING_dev`.`M_PSGL_SRC_LSDR_SRC_SYS_XLATE`
         :  :  :  +- 'SubqueryAlias GL
         :  :  :     +- 'UnresolvedRelation `fdp_mfu_staging_dev`.`m_gl_acct_amt_grp`
         :  :  +- 'SubqueryAlias PER
         :  :     +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY_EMP_RLTD`
         :  +- 'SubqueryAlias PRTYMST1
         :     +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY`
         +- 'SubqueryAlias PRTYMST2
            +- 'UnresolvedRelation `fdp_daas_uat`.`PRTY`

== Analyzed Logical Plan ==
SUBL_ID: string, SUBL_ID_TYPE: string, TRAN_REF_NO: string, CAT_CD: string, UNIQ_ID: string, SRC_SYS: string, CTRY_CD: string, INSTR_ID: null, PTFOL_ID: null, PRTY_ID: string, PRTY_MAIN_ID: string, RISK_PRTY_ID: string, BKR_ID: null, CLRG_BKR_ID: null, CP_ID: string, SRC_RISK_PRTY_ID: string, SRC_BKR_ID: null, SRC_CLRG_BKR_ID: null, ACCT_STS_CD: null, LIFCYCL_STS_CD: string, LOCAL_PRD_CD: string, STD_PRD_CD: string, BK_CD: string, TP_ENT_NM: string, ... 117 more fields
Distinct
+- Project [SUBL_ID#145 AS SUBL_ID#0, SUBL_ID_TYPE#155 AS SUBL_ID_TYPE#1, CASE WHEN ((substring(ACCT_ID#245, -2, 2147483647) = +C) && (GL_AMT_TYPE#160 = BANL)) THEN ACCT_ID#245 WHEN ((substring(ACCT_ID#245, -2, 2147483647) = +I) && (GL_AMT_TYPE#160 = IPIA)) THEN ACCT_ID#245 WHEN ((substring(ACCT_ID#245, -2, 2147483647) = +R) && (GL_AMT_TYPE#160 = RPIP)) THEN ACCT_ID#245 ELSE ACCT_ID#245 END AS TRAN_REF_NO#2, CASE WHEN isnotnull(ACCT_ID#245) THEN ACCT ELSE NA END AS CAT_CD#3, UNIQ_ID#183 AS UNIQ_ID#4, SRC_SYS#142 AS SRC_SYS#5, CTRY_CD#141 AS CTRY_CD#6, null AS INSTR_ID#7, null AS PTFOL_ID#8, PRTY_ID#941 AS PRTY_ID#9, PRTY_ID#722 AS PRTY_MAIN_ID#10, PRTY_ID#1379 AS RISK_PRTY_ID#11, null AS BKR_ID#12, null AS CLRG_BKR_ID#13, CP_ID#287 AS CP_ID#14, RISK_PRTY_ID#403 AS SRC_RISK_PRTY_ID#15, null AS SRC_BKR_ID#16, null AS SRC_CLRG_BKR_ID#17, null AS ACCT_STS_CD#18, LIFCYCL_STS_CD#371 AS LIFCYCL_STS_CD#19, LOCAL_PRD_CD#375 AS LOCAL_PRD_CD#20, STD_PRD_CD#411 AS STD_PRD_CD#21, BK_CD#283 AS BK_CD#22, TP_ENT_NM#418 AS TP_ENT_NM#23, ... 117 more fields]
   +- Filter ((((ODS_VAL#224 = 2024-08-31) && (TP_SYS_VAL#226 = OTP)) && (SRC_SYS#142 = OTP)) && ((NOT GL_ACCT_CD#149 LIKE 9% && isnull(CHRT_FLD_ID#1647)) && (PROCESS_ID_VAL#227 = SUB_LDGR-OTP-FPSLBS)))
      +- Join LeftOuter, ((((PRTY_ID#1977 = RISK_PRTY_ID#403) && (ODS_VAL#2190 = ODS_VAL#224)) && (CTRY_CD#1979 = CTRY_CD#141)) && ((PROCESS_ID_VAL#2193 = PRTY-OTP-CUST) && (ODS_VAL#2190 = 2024-08-31)))
         :- Join LeftOuter, ((((PRTY_ID#1758 = CP_ID#287) && (ODS_VAL#1971 = ODS_VAL#224)) && (CTRY_CD#1760 = CTRY_CD#141)) && ((PROCESS_ID_VAL#1974 = PRTY-OTP-CUST) && (ODS_VAL#1971 = 2024-08-31)))
         :  :- Join LeftOuter, ((((PRTY_ID#941 = PRTY_ID#1737) && (SCI_ENTITY_CODE#1604 = BKG_ORG_VAL#1748)) && ((ODS_VAL#1154 = ODS_VAL#1752) && (STAFF_BIZ_TYPE#1745 = FAM))) && (((PRNC_FAM_FLG#1746 = Y) && isnotnull(EMP_CD#1750)) && ((PROCESS_ID_VAL#1755 = PRTY_EMP_RLTD-SCI-LSPEMPMAP) && (ODS_VAL#1752 = 2024-08-31))))
         :  :  :- Join LeftOuter, ((GL_ACCT_CD#149 = ACCT#1711) && (ODS#1734 = 2024-08-31))
         :  :  :  :- Join LeftOuter, (((SRC_SYS#142 = DERIVED_ADM_TP_SOURCE#1702) && (ODS#1708 = ODS_VAL#224)) && (ODS#1708 = 2024-08-31))
         :  :  :  :  :- Join LeftOuter, ((((GL_ACCT_CD#149 = PSGLACCOUNTFROM#1675) && (GL_BIZ_UNIT_CD#148 = PSGLBU#1674)) && (GL_PRD_CD#154 = PSGLPRODUCTFROM#1677)) && (((GL_DEPT_CD#150 = PSGLDEPTFROM#1679) && (ODS#1689 = ODS_VAL#224)) && (ODS#1689 = 2024-08-31)))
         :  :  :  :  :  :- Join LeftOuter, ((GL_ACCT_CD#149 = CHRT_FLD_ID#1647) && (ODS_VAL#1668 = ODS_VAL#224))
         :  :  :  :  :  :  :- Join LeftOuter, ((((GL_CUST_CLAS_CD#152 = CHRT_FLD_ID#1616) && (ODS_VAL#1637 = ODS_VAL#224)) && (SRC_SYS#1612 = RDM)) && ((CHRT_FLD_TYPE_CD#1621 = CustomerClass) && (ODS_VAL#1637 = 2024-08-31)))
         :  :  :  :  :  :  :  :- Join LeftOuter, ((((CASE WHEN (length(ACCT_REF_ID#579) = cast(12 as int)) THEN substring(ACCT_REF_ID#579, 1, 3) ELSE substring(ACCT_REF_ID#579, 3, 3) END = branch_code#1600) && (CTRY_CD#141 = country_code#1599)) && (cast(ODS#181 as string) = ODS#1609)) && ((ODS#1609 = 2024-08-31) && (tp_system#1598 = OTP)))
         :  :  :  :  :  :  :  :  :- Join LeftOuter, ((((PRTY_ID#1379 = PRTY_ID#706) && (ODS_VAL#1592 = ODS_VAL#716)) && (SRC_SYS#1380 = SCI)) && (((PRTY_CAT_CD#1411 = SubProfile) && (ODS_VAL#1592 = 2024-08-31)) && (PROCESS_ID_VAL#1595 = PRTY-SCI-SUBPROF)))
         :  :  :  :  :  :  :  :  :  :- Join LeftOuter, ((((PRTY_ID#1160 = PRTY_RL_ID#707) && (ODS_VAL#1373 = ODS_VAL#716)) && (SRC_SYS#1161 = SCI)) && (((PRTY_CAT_CD#1192 = MainProfile) && (ODS_VAL#1373 = 2024-08-31)) && (PROCESS_ID_VAL#1376 = PRTY-SCI-MAINPROF)))
         :  :  :  :  :  :  :  :  :  :  :- Join LeftOuter, ((((PRTY_ID#941 = PRTY_ID#690) && (ODS_VAL#1154 = ODS_VAL#700)) && (SRC_SYS#942 = SCI)) && (((PRTY_CAT_CD#973 = SubProfile) && (ODS_VAL#1154 = 2024-08-31)) && (PROCESS_ID_VAL#1157 = PRTY-SCI-SUBPROF)))
         :  :  :  :  :  :  :  :  :  :  :  :- Join LeftOuter, ((((PRTY_ID#722 = PRTY_RL_ID#691) && (ODS_VAL#935 = ODS_VAL#700)) && (SRC_SYS#723 = SCI)) && (((PRTY_CAT_CD#754 = MainProfile) && (ODS_VAL#935 = 2024-08-31)) && (PROCESS_ID_VAL#938 = PRTY-SCI-MAINPROF)))
         :  :  :  :  :  :  :  :  :  :  :  :  :- Join LeftOuter, ((((PRTY_ID#706 = PRTY_ID#674) && (ODS_VAL#716 = ODS_VAL#684)) && (SRC_SYS#708 = SCI)) && (((RL_TYPE_CD#713 = SubProfileToMainProfile) && (ODS_VAL#716 = 2024-08-31)) && (PROCESS_ID_VAL#719 = PRTY_RLTD-SCI-SUBPROF)))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join LeftOuter, ((((PRTY_ID#690 = PRTY_ID#657) && (ODS_VAL#700 = ODS_VAL#667)) && (SRC_SYS#692 = SCI)) && (((RL_TYPE_CD#697 = SubProfileToMainProfile) && (ODS_VAL#700 = 2024-08-31)) && (PROCESS_ID_VAL#703 = PRTY_RLTD-SCI-SUBPROF)))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join LeftOuter, ((((ACCT_ID#673 = ACCT_ID#245) && (ODS_VAL#684 = ODS_VAL#650)) && ((TP_SYS_VAL#686 = TP_SYS_VAL#652) && (SRC_SYS#675 = SRC_SYS#250))) && (((country_val#685 = country_val#651) && (RL_TYPE_CD#679 = RiskPartytoSubprofile)) && ((ODS_VAL#684 = 2024-08-31) && (PROCESS_ID_VAL#687 = PRTY_ACCT_RLTD-OTP-RISKPRTY_FPSL))))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join LeftOuter, ((((ACCT_ID#656 = ACCT_ID#245) && (ODS_VAL#667 = ODS_VAL#650)) && ((TP_SYS_VAL#669 = TP_SYS_VAL#652) && (SRC_SYS#658 = SRC_SYS#250))) && (((country_val#668 = country_val#651) && (RL_TYPE_CD#662 = TPCustomertoSubprofile)) && ((ODS_VAL#667 = 2024-08-31) && (PROCESS_ID_VAL#670 = PRTY_ACCT_RLTD-OTP-TPCUST_FPSL))))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join LeftOuter, ((((ACCT_ID#245 = ACCT_ID#231) && (country_val#651 = country_val#240)) && ((ODS_VAL#650 = ODS_VAL#239) && (TP_SYS_VAL#652 = TP_SYS_VAL#241))) && (((SRC_SYS#250 = OTP) && (PROCESS_ID_VAL#653 = ACCT-OTP-TRDSTATIC)) && (ODS_VAL#650 = 2024-08-31)))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join LeftOuter, ((((SUBL_ID#230 = SUBL_ID#145) && (TP_SYS_VAL#241 = OTP)) && ((SRC_SYS#232 = OTP) && (ODS_VAL#239 = ODS_VAL#224))) && (((country_val#240 = country_val#225) && (RL_TYPE_CD#236 = SubLedgerToAccount)) && ((PROCESS_ID_VAL#242 = SUB_LDGR_ACCT_RLTD-OTP-FPSLBS) && (ODS_VAL#239 = 2024-08-31))))
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias SL
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias sub_ldgr
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[ctry_cd#141,src_sys#142,strt_dt#143,end_dt#144,subl_id#145,ptfol_nm#146,tran_ccy#147,gl_biz_unit_cd#148,gl_acct_cd#149,gl_dept_cd#150,gl_affl_cd#151,gl_cust_clas_cd#152,gl_op_unit_cd#153,gl_prd_cd#154,subl_id_type#155,acct_cat_nm#156,acct_sub_cat_nm#157,local_ccy#158,bal_amt#159,gl_amt_type#160,coa_acct_clas#161,ifrs_sched#162,intco_flg#163,ecl_expsr_flg#164,... 65 more fields] parquet
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias SLACCT_RL
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias sub_ldgr_acct_rltd
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[subl_id#230,acct_id#231,src_sys#232,ctry_cd#233,strt_dt#234,end_dt#235,rl_type_cd#236,ods#237,data_src#238,ods_val#239,country_val#240,tp_sys_val#241,process_id_val#242,frequency_val#243,version_val#244] parquet
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias ACCT
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias acct
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[acct_id#245,acct_ccy#246,ctry_cd#247,end_dt#248,strt_dt#249,src_sys#250,acct_cat_cd#251,acct_clse_dt#252,acct_clsr_rsn#253,acct_cr_int_acr_flg#254,acct_dr_int_acrl_flg#255,acct_drmt_dt#256,acct_frzn_cd#257,acct_in_col_flg#258,acct_int_type_cd#259,acct_int_acc_ccy#260,acct_last_cr_tran_amt#261,acct_last_dr_tran_amt#262,acct_last_exces_tran_amt#263,acct_open_dt#264,acct_open_br_cd#265,acct_pool_flg#266,acct_pool_id#267,acct_prev_cr_tran_dt#268,... 387 more fields] parquet
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias PARL_TPCLIENT
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias prty_acct_rltd
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[acct_id#656,prty_id#657,src_sys#658,ctry_cd#659,strt_dt#660,end_dt#661,rl_type_cd#662,ods#663,role_cd#664,acct_ccy#665,data_src#666,ods_val#667,country_val#668,tp_sys_val#669,process_id_val#670,frequency_val#671,version_val#672] parquet
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias PARL_RISKPRTY
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias prty_acct_rltd
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[acct_id#673,prty_id#674,src_sys#675,ctry_cd#676,strt_dt#677,end_dt#678,rl_type_cd#679,ods#680,role_cd#681,acct_ccy#682,data_src#683,ods_val#684,country_val#685,tp_sys_val#686,process_id_val#687,frequency_val#688,version_val#689] parquet
         :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias PRL_TPCLIENT
         :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias prty_rltd
         :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[prty_id#690,prty_rl_id#691,src_sys#692,ctry_cd#693,strt_dt#694,end_dt#695,pri_flg#696,rl_type_cd#697,ods#698,role_cd#699,ods_val#700,country_val#701,tp_sys_val#702,process_id_val#703,frequency_val#704,version_val#705] parquet
         :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias PRL_RISKPRTY
         :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias prty_rltd
         :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[prty_id#706,prty_rl_id#707,src_sys#708,ctry_cd#709,strt_dt#710,end_dt#711,pri_flg#712,rl_type_cd#713,ods#714,role_cd#715,ods_val#716,country_val#717,tp_sys_val#718,process_id_val#719,frequency_val#720,version_val#721] parquet
         :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias PRTY_MP_TPCLIENT
         :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias prty
         :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[prty_id#722,src_sys#723,ctry_cd#724,strt_dt#725,end_dt#726,prty_biz_type_cd#727,prty_cltr_pldg_rl_cd#728,prty_inc_ctry_cd#729,prty_cr_risk_resp_ctry_cd#730,prty_cr_team_cd#731,data_shr_cnst_flg#732,file_type#733,prty_appr_rvw_dt#734,prty_fm_industry_cd#735,prty_gbl_rtng_flg#736,guaranteed_by_prnt_flg#737,prty_hub_loc#738,prty_ifrs_cp_type_cd#739,prty_lang_cd#740,prty_prnt_supt_elgt_cd#741,prty_affl_cd#742,prty_annl_sales_amt#743,prty_annl_sales_amt_ccy#744,prty_annl_income_amt#745,... 195 more fields] parquet
         :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias PRTY_SP_TPCLIENT
         :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias prty
         :  :  :  :  :  :  :  :  :  :  :        +- Relation[prty_id#941,src_sys#942,ctry_cd#943,strt_dt#944,end_dt#945,prty_biz_type_cd#946,prty_cltr_pldg_rl_cd#947,prty_inc_ctry_cd#948,prty_cr_risk_resp_ctry_cd#949,prty_cr_team_cd#950,data_shr_cnst_flg#951,file_type#952,prty_appr_rvw_dt#953,prty_fm_industry_cd#954,prty_gbl_rtng_flg#955,guaranteed_by_prnt_flg#956,prty_hub_loc#957,prty_ifrs_cp_type_cd#958,prty_lang_cd#959,prty_prnt_supt_elgt_cd#960,prty_affl_cd#961,prty_annl_sales_amt#962,prty_annl_sales_amt_ccy#963,prty_annl_income_amt#964,... 195 more fields] parquet
         :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias PRTY_MP_RISKPRTY
         :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias prty
         :  :  :  :  :  :  :  :  :  :        +- Relation[prty_id#1160,src_sys#1161,ctry_cd#1162,strt_dt#1163,end_dt#1164,prty_biz_type_cd#1165,prty_cltr_pldg_rl_cd#1166,prty_inc_ctry_cd#1167,prty_cr_risk_resp_ctry_cd#1168,prty_cr_team_cd#1169,data_shr_cnst_flg#1170,file_type#1171,prty_appr_rvw_dt#1172,prty_fm_industry_cd#1173,prty_gbl_rtng_flg#1174,guaranteed_by_prnt_flg#1175,prty_hub_loc#1176,prty_ifrs_cp_type_cd#1177,prty_lang_cd#1178,prty_prnt_supt_elgt_cd#1179,prty_affl_cd#1180,prty_annl_sales_amt#1181,prty_annl_sales_amt_ccy#1182,prty_annl_income_amt#1183,... 195 more fields] parquet
         :  :  :  :  :  :  :  :  :  +- SubqueryAlias PRTY_SP_RISKPRTY
         :  :  :  :  :  :  :  :  :     +- SubqueryAlias prty
         :  :  :  :  :  :  :  :  :        +- Relation[prty_id#1379,src_sys#1380,ctry_cd#1381,strt_dt#1382,end_dt#1383,prty_biz_type_cd#1384,prty_cltr_pldg_rl_cd#1385,prty_inc_ctry_cd#1386,prty_cr_risk_resp_ctry_cd#1387,prty_cr_team_cd#1388,data_shr_cnst_flg#1389,file_type#1390,prty_appr_rvw_dt#1391,prty_fm_industry_cd#1392,prty_gbl_rtng_flg#1393,guaranteed_by_prnt_flg#1394,prty_hub_loc#1395,prty_ifrs_cp_type_cd#1396,prty_lang_cd#1397,prty_prnt_supt_elgt_cd#1398,prty_affl_cd#1399,prty_annl_sales_amt#1400,prty_annl_sales_amt_ccy#1401,prty_annl_income_amt#1402,... 195 more fields] parquet
         :  :  :  :  :  :  :  :  +- SubqueryAlias scbentityxlate
         :  :  :  :  :  :  :  :     +- SubqueryAlias m_scb_entity_xlate
         :  :  :  :  :  :  :  :        +- Relation[tp_system#1598,country_code#1599,branch_code#1600,sci_bkg_loctn_id#1601,sci_bkg_loctn_orgn_val#1602,sci_bkl_cntry_iso_cd#1603,sci_entity_code#1604,sci_entity_code_desc#1605,timestamp_d#1606,fdp_is_rollover_flag#1607,fdp_last_processed_date#1608,ods#1609,country#1610,tp_sys#1611] parquet
         :  :  :  :  :  :  :  +- SubqueryAlias COA
         :  :  :  :  :  :  :     +- SubqueryAlias chrt_of_acct
         :  :  :  :  :  :  :        +- Relation[src_sys#1612,strt_dt#1613,end_dt#1614,set_id#1615,chrt_fld_id#1616,eff_dt#1617,eff_sts#1618,desc#1619,short_desc#1620,chrt_fld_type_cd#1621,islm_flg#1622,chrt_fld_cat_cd#1623,grp_solo_flg#1624,chrt_fld_ctry_cd#1625,chrt_fld_lvl_0#1626,chrt_fld_lvl_0_desc#1627,chrt_fld_lvl_1#1628,chrt_fld_lvl_1_desc#1629,ods#1630,chrt_fld_ccy#1631,pgc_ifrss_sch#1632,pgc_ifrss_sch_desc#1633,pgc_grp_nongrp#1634,pgc_mr_sch_ref#1635,... 7 more fields] parquet
         :  :  :  :  :  :  +- SubqueryAlias PGC
         :  :  :  :  :  :     +- Distinct
         :  :  :  :  :  :        +- Project [CHRT_FLD_ID#1647, DESC#1650, CHRT_FLD_CAT_CD#1654, SRC_SYS#1643, CHRT_FLD_TYPE_CD#1652, PGC_IFRSS_SCH#1663, PGC_IFRSS_SCH_DESC#1664, PGC_GRP_NONGRP#1665, PGC_MR_SCH_REF#1666, ODS_VAL#1668]
         :  :  :  :  :  :           +- Filter (((ODS_VAL#1668 = 2024-08-31) && CHRT_FLD_CAT_CD#1654 LIKE %P/L%) && ((SRC_SYS#1643 = RDM) && (CHRT_FLD_TYPE_CD#1652 = Account)))
         :  :  :  :  :  :              +- SubqueryAlias PGC
         :  :  :  :  :  :                 +- SubqueryAlias chrt_of_acct
         :  :  :  :  :  :                    +- Relation[src_sys#1643,strt_dt#1644,end_dt#1645,set_id#1646,chrt_fld_id#1647,eff_dt#1648,eff_sts#1649,desc#1650,short_desc#1651,chrt_fld_type_cd#1652,islm_flg#1653,chrt_fld_cat_cd#1654,grp_solo_flg#1655,chrt_fld_ctry_cd#1656,chrt_fld_lvl_0#1657,chrt_fld_lvl_0_desc#1658,chrt_fld_lvl_1#1659,chrt_fld_lvl_1_desc#1660,ods#1661,chrt_fld_ccy#1662,pgc_ifrss_sch#1663,pgc_ifrss_sch_desc#1664,pgc_grp_nongrp#1665,pgc_mr_sch_ref#1666,... 7 more fields] parquet
         :  :  :  :  :  +- SubqueryAlias ACCTCLASS
         :  :  :  :  :     +- SubqueryAlias m_ifrs9_acct_class_xlate
         :  :  :  :  :        +- Relation[psglbu#1674,psglaccountfrom#1675,psglaccountto#1676,psglproductfrom#1677,psglproductto#1678,psgldeptfrom#1679,psgldeptto#1680,ifrsschedule#1681,accountingclassification#1682,currency#1683,priority#1684,flag#1685,timestamp_d#1686,fdp_is_rollover_flag#1687,fdp_last_processed_date#1688,ods#1689,country#1690,tp_sys#1691] parquet
         :  :  :  :  +- SubqueryAlias JRNLSRC
         :  :  :  :     +- Distinct
         :  :  :  :        +- Project [derived_adm_tp_source#1702, derived_adm_jrnl_src#1703, ods#1708]
         :  :  :  :           +- Filter (ODS#1708 = 2024-08-31)
         :  :  :  :              +- SubqueryAlias m_psgl_src_lsdr_src_sys_xlate
         :  :  :  :                 +- Relation[journal_source_code#1692,description#1693,status#1694,source_type#1695,branch#1696,suspend_recycle#1697,tp_recon#1698,equivalent_tp_or_pseudo_source#1699,tp_or_pseudo_source_description#1700,pe_bal_source_ledger_scope#1701,derived_adm_tp_source#1702,derived_adm_jrnl_src#1703,timestamp_d#1704,revn_source_ledger_scope#1705,fdp_is_rollover_flag#1706,fdp_last_processed_date#1707,ods#1708,country#1709,tp_sys#1710] parquet
         :  :  :  +- SubqueryAlias GL
         :  :  :     +- SubqueryAlias m_gl_acct_amt_grp
         :  :  :        +- Relation[acct#1711,desc#1712,def#1713,cat#1714,grp_non_grp_cd#1715,ifrs_pack_sch_ref#1716,ifrs_pack_sch_desc#1717,ifrs_ln_item#1718,ifrs_pack_acct_nd#1719,mr_pack_sch_ref#1720,mr_line_itm#1721,mr_pack_acct_nd#1722,rtl_cube_map#1723,pri#1724,sec#1725,actvty#1726,data_prd#1727,amt_main_grp#1728,amt_sub_grp#1729,timestamp_d#1730,amt_cat#1731,fdp_is_rollover_flag#1732,fdp_last_processed_date#1733,ods#1734,... 2 more fields] parquet
         :  :  +- SubqueryAlias PER
         :  :     +- SubqueryAlias prty_emp_rltd
         :  :        +- Relation[prty_id#1737,emp_id#1738,src_sys#1739,ctry_cd#1740,strt_dt#1741,end_dt#1742,rl_type_cd#1743,role_cd#1744,staff_biz_type#1745,prnc_fam_flg#1746,ods#1747,bkg_org_val#1748,bkg_loc#1749,emp_cd#1750,emp_desc#1751,ods_val#1752,country_val#1753,tp_sys_val#1754,process_id_val#1755,frequency_val#1756,version_val#1757] parquet
         :  +- SubqueryAlias PRTYMST1
         :     +- SubqueryAlias prty
         :        +- Relation[prty_id#1758,src_sys#1759,ctry_cd#1760,strt_dt#1761,end_dt#1762,prty_biz_type_cd#1763,prty_cltr_pldg_rl_cd#1764,prty_inc_ctry_cd#1765,prty_cr_risk_resp_ctry_cd#1766,prty_cr_team_cd#1767,data_shr_cnst_flg#1768,file_type#1769,prty_appr_rvw_dt#1770,prty_fm_industry_cd#1771,prty_gbl_rtng_flg#1772,guaranteed_by_prnt_flg#1773,prty_hub_loc#1774,prty_ifrs_cp_type_cd#1775,prty_lang_cd#1776,prty_prnt_supt_elgt_cd#1777,prty_affl_cd#1778,prty_annl_sales_amt#1779,prty_annl_sales_amt_ccy#1780,prty_annl_income_amt#1781,... 195 more fields] parquet
         +- SubqueryAlias PRTYMST2
            +- SubqueryAlias prty
               +- Relation[prty_id#1977,src_sys#1978,ctry_cd#1979,strt_dt#1980,end_dt#1981,prty_biz_type_cd#1982,prty_cltr_pldg_rl_cd#1983,prty_inc_ctry_cd#1984,prty_cr_risk_resp_ctry_cd#1985,prty_cr_team_cd#1986,data_shr_cnst_flg#1987,file_type#1988,prty_appr_rvw_dt#1989,prty_fm_industry_cd#1990,prty_gbl_rtng_flg#1991,guaranteed_by_prnt_flg#1992,prty_hub_loc#1993,prty_ifrs_cp_type_cd#1994,prty_lang_cd#1995,prty_prnt_supt_elgt_cd#1996,prty_affl_cd#1997,prty_annl_sales_amt#1998,prty_annl_sales_amt_ccy#1999,prty_annl_income_amt#2000,... 195 more fields] parquet

== Optimized Logical Plan ==
Aggregate [SUBL_ID#0, SUBL_ID_TYPE#1, TRAN_REF_NO#2, CAT_CD#3, UNIQ_ID#4, SRC_SYS#142, CTRY_CD#141, null, null, PRTY_ID#941, PRTY_MAIN_ID#10, RISK_PRTY_ID#11, null, null, CP_ID#14, SRC_RISK_PRTY_ID#15, null, null, null, LIFCYCL_STS_CD#19, LOCAL_PRD_CD#20, STD_PRD_CD#21, BK_CD#22, TP_ENT_NM#23, ... 117 more fields], [SUBL_ID#0, SUBL_ID_TYPE#1, TRAN_REF_NO#2, CAT_CD#3, UNIQ_ID#4, SRC_SYS#142, CTRY_CD#141, null AS INSTR_ID#7, null AS PTFOL_ID#8, PRTY_ID#941, PRTY_MAIN_ID#10, RISK_PRTY_ID#11, null AS BKR_ID#12, null AS CLRG_BKR_ID#13, CP_ID#14, SRC_RISK_PRTY_ID#15, null AS SRC_BKR_ID#16, null AS SRC_CLRG_BKR_ID#17, null AS ACCT_STS_CD#18, LIFCYCL_STS_CD#19, LOCAL_PRD_CD#20, STD_PRD_CD#21, BK_CD#22, TP_ENT_NM#23, ... 117 more fields]
+- Project [SUBL_ID#145 AS SUBL_ID#0, SUBL_ID_TYPE#155 AS SUBL_ID_TYPE#1, CASE WHEN ((substring(ACCT_ID#245, -2, 2147483647) = +C) && (GL_AMT_TYPE#160 = BANL)) THEN ACCT_ID#245 WHEN ((substring(ACCT_ID#245, -2, 2147483647) = +I) && (GL_AMT_TYPE#160 = IPIA)) THEN ACCT_ID#245 WHEN ((substring(ACCT_ID#245, -2, 2147483647) = +R) && (GL_AMT_TYPE#160 = RPIP)) THEN ACCT_ID#245 ELSE ACCT_ID#245 END AS TRAN_REF_NO#2, CASE WHEN isnotnull(ACCT_ID#245) THEN ACCT ELSE NA END AS CAT_CD#3, UNIQ_ID#183 AS UNIQ_ID#4, SRC_SYS#142, CTRY_CD#141, PRTY_ID#941, PRTY_ID#722 AS PRTY_MAIN_ID#10, PRTY_ID#1379 AS RISK_PRTY_ID#11, CP_ID#287 AS CP_ID#14, RISK_PRTY_ID#403 AS SRC_RISK_PRTY_ID#15, LIFCYCL_STS_CD#371 AS LIFCYCL_STS_CD#19, LOCAL_PRD_CD#375 AS LOCAL_PRD_CD#20, STD_PRD_CD#411 AS STD_PRD_CD#21, BK_CD#283 AS BK_CD#22, TP_ENT_NM#418 AS TP_ENT_NM#23, LGL_ENT_CD#179, SCI_ENTITY_CODE#1604 AS BKG_LOC_CD#25, LN_EFF_DT#373 AS ADJ_VAL_DT_1#26, FST_LN_DRWDOWN_DT#330 AS TRD_DT#27, MATURITY_DT#377, SETLM_DT#409, ACCT_REF_ID#579 AS CONTR_ID#33, ... 96 more fields]
   +- Join LeftOuter, (((PRTY_ID#1977 = RISK_PRTY_ID#403) && (ODS_VAL#2190 = ODS_VAL#224)) && (CTRY_CD#1979 = CTRY_CD#141))
      :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 93 more fields]
      :  +- Join LeftOuter, (((PRTY_ID#1758 = CP_ID#287) && (ODS_VAL#1971 = ODS_VAL#224)) && (CTRY_CD#1760 = CTRY_CD#141))
      :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 92 more fields]
      :     :  +- Join LeftOuter, (((PRTY_ID#941 = PRTY_ID#1737) && (SCI_ENTITY_CODE#1604 = BKG_ORG_VAL#1748)) && (ODS_VAL#1154 = ODS_VAL#1752))
      :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 92 more fields]
      :     :     :  +- Join LeftOuter, (GL_ACCT_CD#149 = ACCT#1711)
      :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 92 more fields]
      :     :     :     :  +- Join LeftOuter, ((SRC_SYS#142 = DERIVED_ADM_TP_SOURCE#1702) && (ODS#1708 = ODS_VAL#224))
      :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 91 more fields]
      :     :     :     :     :  +- Join LeftOuter, (((((GL_ACCT_CD#149 = PSGLACCOUNTFROM#1675) && (GL_BIZ_UNIT_CD#148 = PSGLBU#1674)) && (GL_PRD_CD#154 = PSGLPRODUCTFROM#1677)) && (GL_DEPT_CD#150 = PSGLDEPTFROM#1679)) && (ODS#1689 = ODS_VAL#224))
      :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 90 more fields]
      :     :     :     :     :     :  +- Filter isnull(CHRT_FLD_ID#1647)
      :     :     :     :     :     :     +- Join LeftOuter, ((GL_ACCT_CD#149 = CHRT_FLD_ID#1647) && (ODS_VAL#1668 = ODS_VAL#224))
      :     :     :     :     :     :        :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 84 more fields]
      :     :     :     :     :     :        :  +- Join LeftOuter, ((GL_CUST_CLAS_CD#152 = CHRT_FLD_ID#1616) && (ODS_VAL#1637 = ODS_VAL#224))
      :     :     :     :     :     :        :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 83 more fields]
      :     :     :     :     :     :        :     :  +- Join LeftOuter, (((CASE WHEN (length(ACCT_REF_ID#579) = 12) THEN substring(ACCT_REF_ID#579, 1, 3) ELSE substring(ACCT_REF_ID#579, 3, 3) END = branch_code#1600) && (CTRY_CD#141 = country_code#1599)) && (cast(ODS#181 as string) = ODS#1609))
      :     :     :     :     :     :        :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 83 more fields]
      :     :     :     :     :     :        :     :     :  +- Join LeftOuter, ((PRTY_ID#1379 = PRTY_ID#706) && (ODS_VAL#1592 = ODS_VAL#716))
      :     :     :     :     :     :        :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 84 more fields]
      :     :     :     :     :     :        :     :     :     :  +- Join LeftOuter, ((PRTY_ID#1160 = PRTY_RL_ID#707) && (ODS_VAL#1373 = ODS_VAL#716))
      :     :     :     :     :     :        :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 84 more fields]
      :     :     :     :     :     :        :     :     :     :     :  +- Join LeftOuter, ((PRTY_ID#941 = PRTY_ID#690) && (ODS_VAL#1154 = ODS_VAL#700))
      :     :     :     :     :     :        :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 83 more fields]
      :     :     :     :     :     :        :     :     :     :     :     :  +- Join LeftOuter, ((PRTY_ID#722 = PRTY_RL_ID#691) && (ODS_VAL#935 = ODS_VAL#700))
      :     :     :     :     :     :        :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 83 more fields]
      :     :     :     :     :     :        :     :     :     :     :     :     :  +- Join LeftOuter, ((PRTY_ID#706 = PRTY_ID#674) && (ODS_VAL#716 = ODS_VAL#684))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 82 more fields]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :  +- Join LeftOuter, ((PRTY_ID#690 = PRTY_ID#657) && (ODS_VAL#700 = ODS_VAL#667))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 81 more fields]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :  +- Join LeftOuter, (((((ACCT_ID#673 = ACCT_ID#245) && (ODS_VAL#684 = ODS_VAL#650)) && (TP_SYS_VAL#686 = TP_SYS_VAL#652)) && (SRC_SYS#675 = SRC_SYS#250)) && (country_val#685 = country_val#651))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 83 more fields]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :  +- Join LeftOuter, (((((ACCT_ID#656 = ACCT_ID#245) && (ODS_VAL#667 = ODS_VAL#650)) && (TP_SYS_VAL#669 = TP_SYS_VAL#652)) && (SRC_SYS#658 = SRC_SYS#250)) && (country_val#668 = country_val#651))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 81 more fields]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :  +- Join LeftOuter, ((((ACCT_ID#245 = ACCT_ID#231) && (country_val#651 = country_val#240)) && (ODS_VAL#650 = ODS_VAL#239)) && (TP_SYS_VAL#652 = TP_SYS_VAL#241))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 37 more fields]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :  +- Join LeftOuter, (((SUBL_ID#230 = SUBL_ID#145) && (ODS_VAL#239 = ODS_VAL#224)) && (country_val#240 = country_val#225))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 34 more fields]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :     :  +- Filter (((((((((isnotnull(PROCESS_ID_VAL#227) && isnotnull(ODS_VAL#224)) && isnotnull(GL_ACCT_CD#149)) && isnotnull(SRC_SYS#142)) && isnotnull(TP_SYS_VAL#226)) && (ODS_VAL#224 = 2024-08-31)) && (TP_SYS_VAL#226 = OTP)) && (SRC_SYS#142 = OTP)) && NOT StartsWith(GL_ACCT_CD#149, 9)) && (PROCESS_ID_VAL#227 = SUB_LDGR-OTP-FPSLBS))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :     :     +- Relation[ctry_cd#141,src_sys#142,strt_dt#143,end_dt#144,subl_id#145,ptfol_nm#146,tran_ccy#147,gl_biz_unit_cd#148,gl_acct_cd#149,gl_dept_cd#150,gl_affl_cd#151,gl_cust_clas_cd#152,gl_op_unit_cd#153,gl_prd_cd#154,subl_id_type#155,acct_cat_nm#156,acct_sub_cat_nm#157,local_ccy#158,bal_amt#159,gl_amt_type#160,coa_acct_clas#161,ifrs_sched#162,intco_flg#163,ecl_expsr_flg#164,... 65 more fields] parquet
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :     +- Project [subl_id#230, acct_id#231, ods_val#239, country_val#240, tp_sys_val#241]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((((((isnotnull(RL_TYPE_CD#236) && isnotnull(SRC_SYS#232)) && isnotnull(TP_SYS_VAL#241)) && isnotnull(ODS_VAL#239)) && isnotnull(PROCESS_ID_VAL#242)) && (TP_SYS_VAL#241 = OTP)) && (SRC_SYS#232 = OTP)) && (RL_TYPE_CD#236 = SubLedgerToAccount)) && (PROCESS_ID_VAL#242 = SUB_LDGR_ACCT_RLTD-OTP-FPSLBS)) && (ODS_VAL#239 = 2024-08-31))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :           +- Relation[subl_id#230,acct_id#231,src_sys#232,ctry_cd#233,strt_dt#234,end_dt#235,rl_type_cd#236,ods#237,data_src#238,ods_val#239,country_val#240,tp_sys_val#241,process_id_val#242,frequency_val#243,version_val#244] parquet
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     +- Project [acct_id#245, src_sys#250, acct_clse_dt#252, acct_open_dt#264, acct_open_br_cd#265, bk_cd#283, cp_id#287, cust_mrgn_rt#304, day_cnt_conv_cd#308, disapproved_period#327, fac_orig_loc#328, fst_ln_drwdown_dt#330, int_rt#353, int_rt_type#355, lifcycl_sts_cd#371, ln_eff_dt#373, local_prd_cd#375, maturity_dt#377, obl_flg#384, recrse_flg#401, risk_prty_id#403, sel_down_flg#408, setlm_dt#409, std_prd_cd#411, ... 24 more fields]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(SRC_SYS#250) && isnotnull(ODS_VAL#650)) && isnotnull(PROCESS_ID_VAL#653)) && (SRC_SYS#250 = OTP)) && (PROCESS_ID_VAL#653 = ACCT-OTP-TRDSTATIC)) && (ODS_VAL#650 = 2024-08-31))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :           +- Relation[acct_id#245,acct_ccy#246,ctry_cd#247,end_dt#248,strt_dt#249,src_sys#250,acct_cat_cd#251,acct_clse_dt#252,acct_clsr_rsn#253,acct_cr_int_acr_flg#254,acct_dr_int_acrl_flg#255,acct_drmt_dt#256,acct_frzn_cd#257,acct_in_col_flg#258,acct_int_type_cd#259,acct_int_acc_ccy#260,acct_last_cr_tran_amt#261,acct_last_dr_tran_amt#262,acct_last_exces_tran_amt#263,acct_open_dt#264,acct_open_br_cd#265,acct_pool_flg#266,acct_pool_id#267,acct_prev_cr_tran_dt#268,... 387 more fields] parquet
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     +- Project [acct_id#656, prty_id#657, src_sys#658, ods_val#667, country_val#668, tp_sys_val#669]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(ODS_VAL#667) && isnotnull(PROCESS_ID_VAL#670)) && isnotnull(RL_TYPE_CD#662)) && (RL_TYPE_CD#662 = TPCustomertoSubprofile)) && (ODS_VAL#667 = 2024-08-31)) && (PROCESS_ID_VAL#670 = PRTY_ACCT_RLTD-OTP-TPCUST_FPSL))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :           +- Relation[acct_id#656,prty_id#657,src_sys#658,ctry_cd#659,strt_dt#660,end_dt#661,rl_type_cd#662,ods#663,role_cd#664,acct_ccy#665,data_src#666,ods_val#667,country_val#668,tp_sys_val#669,process_id_val#670,frequency_val#671,version_val#672] parquet
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     +- Project [acct_id#673, prty_id#674, src_sys#675, ods_val#684, country_val#685, tp_sys_val#686]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :        +- Filter (((((isnotnull(PROCESS_ID_VAL#687) && isnotnull(ODS_VAL#684)) && isnotnull(RL_TYPE_CD#679)) && (RL_TYPE_CD#679 = RiskPartytoSubprofile)) && (ODS_VAL#684 = 2024-08-31)) && (PROCESS_ID_VAL#687 = PRTY_ACCT_RLTD-OTP-RISKPRTY_FPSL))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     :           +- Relation[acct_id#673,prty_id#674,src_sys#675,ctry_cd#676,strt_dt#677,end_dt#678,rl_type_cd#679,ods#680,role_cd#681,acct_ccy#682,data_src#683,ods_val#684,country_val#685,tp_sys_val#686,process_id_val#687,frequency_val#688,version_val#689] parquet
      :     :     :     :     :     :        :     :     :     :     :     :     :     :     +- Project [prty_id#690, prty_rl_id#691, ods_val#700]
      :     :     :     :     :     :        :     :     :     :     :     :     :     :        +- Filter (((((((isnotnull(RL_TYPE_CD#697) && isnotnull(PROCESS_ID_VAL#703)) && isnotnull(ODS_VAL#700)) && isnotnull(SRC_SYS#692)) && (SRC_SYS#692 = SCI)) && (RL_TYPE_CD#697 = SubProfileToMainProfile)) && (ODS_VAL#700 = 2024-08-31)) && (PROCESS_ID_VAL#703 = PRTY_RLTD-SCI-SUBPROF))
      :     :     :     :     :     :        :     :     :     :     :     :     :     :           +- Relation[prty_id#690,prty_rl_id#691,src_sys#692,ctry_cd#693,strt_dt#694,end_dt#695,pri_flg#696,rl_type_cd#697,ods#698,role_cd#699,ods_val#700,country_val#701,tp_sys_val#702,process_id_val#703,frequency_val#704,version_val#705] parquet
      :     :     :     :     :     :        :     :     :     :     :     :     :     +- Project [prty_id#706, prty_rl_id#707, ods_val#716]
      :     :     :     :     :     :        :     :     :     :     :     :     :        +- Filter (((((((isnotnull(ODS_VAL#716) && isnotnull(SRC_SYS#708)) && isnotnull(RL_TYPE_CD#713)) && isnotnull(PROCESS_ID_VAL#719)) && (SRC_SYS#708 = SCI)) && (RL_TYPE_CD#713 = SubProfileToMainProfile)) && (ODS_VAL#716 = 2024-08-31)) && (PROCESS_ID_VAL#719 = PRTY_RLTD-SCI-SUBPROF))
      :     :     :     :     :     :        :     :     :     :     :     :     :           +- Relation[prty_id#706,prty_rl_id#707,src_sys#708,ctry_cd#709,strt_dt#710,end_dt#711,pri_flg#712,rl_type_cd#713,ods#714,role_cd#715,ods_val#716,country_val#717,tp_sys_val#718,process_id_val#719,frequency_val#720,version_val#721] parquet
      :     :     :     :     :     :        :     :     :     :     :     :     +- Project [prty_id#722, ods_val#935]
      :     :     :     :     :     :        :     :     :     :     :     :        +- Filter (((((((isnotnull(PROCESS_ID_VAL#938) && isnotnull(PRTY_CAT_CD#754)) && isnotnull(SRC_SYS#723)) && isnotnull(ODS_VAL#935)) && (SRC_SYS#723 = SCI)) && (PRTY_CAT_CD#754 = MainProfile)) && (ODS_VAL#935 = 2024-08-31)) && (PROCESS_ID_VAL#938 = PRTY-SCI-MAINPROF))
      :     :     :     :     :     :        :     :     :     :     :     :           +- Relation[prty_id#722,src_sys#723,ctry_cd#724,strt_dt#725,end_dt#726,prty_biz_type_cd#727,prty_cltr_pldg_rl_cd#728,prty_inc_ctry_cd#729,prty_cr_risk_resp_ctry_cd#730,prty_cr_team_cd#731,data_shr_cnst_flg#732,file_type#733,prty_appr_rvw_dt#734,prty_fm_industry_cd#735,prty_gbl_rtng_flg#736,guaranteed_by_prnt_flg#737,prty_hub_loc#738,prty_ifrs_cp_type_cd#739,prty_lang_cd#740,prty_prnt_supt_elgt_cd#741,prty_affl_cd#742,prty_annl_sales_amt#743,prty_annl_sales_amt_ccy#744,prty_annl_income_amt#745,... 195 more fields] parquet
      :     :     :     :     :     :        :     :     :     :     :     +- Project [prty_id#941, prty_ifrs_cp_type_cd#958, ods_val#1154]
      :     :     :     :     :     :        :     :     :     :     :        +- Filter (((((((isnotnull(PRTY_CAT_CD#973) && isnotnull(ODS_VAL#1154)) && isnotnull(PROCESS_ID_VAL#1157)) && isnotnull(SRC_SYS#942)) && (SRC_SYS#942 = SCI)) && (PRTY_CAT_CD#973 = SubProfile)) && (ODS_VAL#1154 = 2024-08-31)) && (PROCESS_ID_VAL#1157 = PRTY-SCI-SUBPROF))
      :     :     :     :     :     :        :     :     :     :     :           +- Relation[prty_id#941,src_sys#942,ctry_cd#943,strt_dt#944,end_dt#945,prty_biz_type_cd#946,prty_cltr_pldg_rl_cd#947,prty_inc_ctry_cd#948,prty_cr_risk_resp_ctry_cd#949,prty_cr_team_cd#950,data_shr_cnst_flg#951,file_type#952,prty_appr_rvw_dt#953,prty_fm_industry_cd#954,prty_gbl_rtng_flg#955,guaranteed_by_prnt_flg#956,prty_hub_loc#957,prty_ifrs_cp_type_cd#958,prty_lang_cd#959,prty_prnt_supt_elgt_cd#960,prty_affl_cd#961,prty_annl_sales_amt#962,prty_annl_sales_amt_ccy#963,prty_annl_income_amt#964,... 195 more fields] parquet
      :     :     :     :     :     :        :     :     :     :     +- Project [prty_id#1160, ods_val#1373]
      :     :     :     :     :     :        :     :     :     :        +- Filter (((((((isnotnull(PRTY_CAT_CD#1192) && isnotnull(ODS_VAL#1373)) && isnotnull(SRC_SYS#1161)) && isnotnull(PROCESS_ID_VAL#1376)) && (SRC_SYS#1161 = SCI)) && (PRTY_CAT_CD#1192 = MainProfile)) && (ODS_VAL#1373 = 2024-08-31)) && (PROCESS_ID_VAL#1376 = PRTY-SCI-MAINPROF))
      :     :     :     :     :     :        :     :     :     :           +- Relation[prty_id#1160,src_sys#1161,ctry_cd#1162,strt_dt#1163,end_dt#1164,prty_biz_type_cd#1165,prty_cltr_pldg_rl_cd#1166,prty_inc_ctry_cd#1167,prty_cr_risk_resp_ctry_cd#1168,prty_cr_team_cd#1169,data_shr_cnst_flg#1170,file_type#1171,prty_appr_rvw_dt#1172,prty_fm_industry_cd#1173,prty_gbl_rtng_flg#1174,guaranteed_by_prnt_flg#1175,prty_hub_loc#1176,prty_ifrs_cp_type_cd#1177,prty_lang_cd#1178,prty_prnt_supt_elgt_cd#1179,prty_affl_cd#1180,prty_annl_sales_amt#1181,prty_annl_sales_amt_ccy#1182,prty_annl_income_amt#1183,... 195 more fields] parquet
      :     :     :     :     :     :        :     :     :     +- Project [prty_id#1379, ods_val#1592]
      :     :     :     :     :     :        :     :     :        +- Filter (((((((isnotnull(SRC_SYS#1380) && isnotnull(ODS_VAL#1592)) && isnotnull(PROCESS_ID_VAL#1595)) && isnotnull(PRTY_CAT_CD#1411)) && (SRC_SYS#1380 = SCI)) && (PRTY_CAT_CD#1411 = SubProfile)) && (ODS_VAL#1592 = 2024-08-31)) && (PROCESS_ID_VAL#1595 = PRTY-SCI-SUBPROF))
      :     :     :     :     :     :        :     :     :           +- Relation[prty_id#1379,src_sys#1380,ctry_cd#1381,strt_dt#1382,end_dt#1383,prty_biz_type_cd#1384,prty_cltr_pldg_rl_cd#1385,prty_inc_ctry_cd#1386,prty_cr_risk_resp_ctry_cd#1387,prty_cr_team_cd#1388,data_shr_cnst_flg#1389,file_type#1390,prty_appr_rvw_dt#1391,prty_fm_industry_cd#1392,prty_gbl_rtng_flg#1393,guaranteed_by_prnt_flg#1394,prty_hub_loc#1395,prty_ifrs_cp_type_cd#1396,prty_lang_cd#1397,prty_prnt_supt_elgt_cd#1398,prty_affl_cd#1399,prty_annl_sales_amt#1400,prty_annl_sales_amt_ccy#1401,prty_annl_income_amt#1402,... 195 more fields] parquet
      :     :     :     :     :     :        :     :     +- Project [country_code#1599, branch_code#1600, sci_entity_code#1604, ods#1609]
      :     :     :     :     :     :        :     :        +- Filter (((isnotnull(ODS#1609) && isnotnull(tp_system#1598)) && (ODS#1609 = 2024-08-31)) && (tp_system#1598 = OTP))
      :     :     :     :     :     :        :     :           +- Relation[tp_system#1598,country_code#1599,branch_code#1600,sci_bkg_loctn_id#1601,sci_bkg_loctn_orgn_val#1602,sci_bkl_cntry_iso_cd#1603,sci_entity_code#1604,sci_entity_code_desc#1605,timestamp_d#1606,fdp_is_rollover_flag#1607,fdp_last_processed_date#1608,ods#1609,country#1610,tp_sys#1611] parquet
      :     :     :     :     :     :        :     +- Project [chrt_fld_id#1616, chrt_fld_lvl_0#1626, ods_val#1637]
      :     :     :     :     :     :        :        +- Filter (((((isnotnull(CHRT_FLD_TYPE_CD#1621) && isnotnull(SRC_SYS#1612)) && isnotnull(ODS_VAL#1637)) && (SRC_SYS#1612 = RDM)) && (CHRT_FLD_TYPE_CD#1621 = CustomerClass)) && (ODS_VAL#1637 = 2024-08-31))
      :     :     :     :     :     :        :           +- Relation[src_sys#1612,strt_dt#1613,end_dt#1614,set_id#1615,chrt_fld_id#1616,eff_dt#1617,eff_sts#1618,desc#1619,short_desc#1620,chrt_fld_type_cd#1621,islm_flg#1622,chrt_fld_cat_cd#1623,grp_solo_flg#1624,chrt_fld_ctry_cd#1625,chrt_fld_lvl_0#1626,chrt_fld_lvl_0_desc#1627,chrt_fld_lvl_1#1628,chrt_fld_lvl_1_desc#1629,ods#1630,chrt_fld_ccy#1631,pgc_ifrss_sch#1632,pgc_ifrss_sch_desc#1633,pgc_grp_nongrp#1634,pgc_mr_sch_ref#1635,... 7 more fields] parquet
      :     :     :     :     :     :        +- Aggregate [CHRT_FLD_ID#1647, DESC#1650, CHRT_FLD_CAT_CD#1654, SRC_SYS#1643, CHRT_FLD_TYPE_CD#1652, PGC_IFRSS_SCH#1663, PGC_IFRSS_SCH_DESC#1664, PGC_GRP_NONGRP#1665, PGC_MR_SCH_REF#1666, ODS_VAL#1668], [CHRT_FLD_ID#1647, DESC#1650, CHRT_FLD_CAT_CD#1654, PGC_IFRSS_SCH#1663, PGC_IFRSS_SCH_DESC#1664, PGC_GRP_NONGRP#1665, PGC_MR_SCH_REF#1666, ODS_VAL#1668]
      :     :     :     :     :     :           +- Project [CHRT_FLD_ID#1647, DESC#1650, CHRT_FLD_CAT_CD#1654, SRC_SYS#1643, CHRT_FLD_TYPE_CD#1652, PGC_IFRSS_SCH#1663, PGC_IFRSS_SCH_DESC#1664, PGC_GRP_NONGRP#1665, PGC_MR_SCH_REF#1666, ODS_VAL#1668]
      :     :     :     :     :     :              +- Filter (((((((isnotnull(CHRT_FLD_TYPE_CD#1652) && isnotnull(CHRT_FLD_CAT_CD#1654)) && isnotnull(ODS_VAL#1668)) && isnotnull(SRC_SYS#1643)) && (ODS_VAL#1668 = 2024-08-31)) && Contains(CHRT_FLD_CAT_CD#1654, P/L)) && (SRC_SYS#1643 = RDM)) && (CHRT_FLD_TYPE_CD#1652 = Account))
      :     :     :     :     :     :                 +- Relation[src_sys#1643,strt_dt#1644,end_dt#1645,set_id#1646,chrt_fld_id#1647,eff_dt#1648,eff_sts#1649,desc#1650,short_desc#1651,chrt_fld_type_cd#1652,islm_flg#1653,chrt_fld_cat_cd#1654,grp_solo_flg#1655,chrt_fld_ctry_cd#1656,chrt_fld_lvl_0#1657,chrt_fld_lvl_0_desc#1658,chrt_fld_lvl_1#1659,chrt_fld_lvl_1_desc#1660,ods#1661,chrt_fld_ccy#1662,pgc_ifrss_sch#1663,pgc_ifrss_sch_desc#1664,pgc_grp_nongrp#1665,pgc_mr_sch_ref#1666,... 7 more fields] parquet
      :     :     :     :     :     +- Project [psglbu#1674, psglaccountfrom#1675, psglproductfrom#1677, psgldeptfrom#1679, accountingclassification#1682, ods#1689]
      :     :     :     :     :        +- Filter (isnotnull(ODS#1689) && (ODS#1689 = 2024-08-31))
      :     :     :     :     :           +- Relation[psglbu#1674,psglaccountfrom#1675,psglaccountto#1676,psglproductfrom#1677,psglproductto#1678,psgldeptfrom#1679,psgldeptto#1680,ifrsschedule#1681,accountingclassification#1682,currency#1683,priority#1684,flag#1685,timestamp_d#1686,fdp_is_rollover_flag#1687,fdp_last_processed_date#1688,ods#1689,country#1690,tp_sys#1691] parquet
      :     :     :     :     +- Aggregate [derived_adm_tp_source#1702, derived_adm_jrnl_src#1703, ods#1708], [derived_adm_tp_source#1702, derived_adm_jrnl_src#1703, ods#1708]
      :     :     :     :        +- Project [derived_adm_tp_source#1702, derived_adm_jrnl_src#1703, ods#1708]
      :     :     :     :           +- Filter (isnotnull(ODS#1708) && (ODS#1708 = 2024-08-31))
      :     :     :     :              +- Relation[journal_source_code#1692,description#1693,status#1694,source_type#1695,branch#1696,suspend_recycle#1697,tp_recon#1698,equivalent_tp_or_pseudo_source#1699,tp_or_pseudo_source_description#1700,pe_bal_source_ledger_scope#1701,derived_adm_tp_source#1702,derived_adm_jrnl_src#1703,timestamp_d#1704,revn_source_ledger_scope#1705,fdp_is_rollover_flag#1706,fdp_last_processed_date#1707,ods#1708,country#1709,tp_sys#1710] parquet
      :     :     :     +- Project [acct#1711]
      :     :     :        +- Filter (isnotnull(ODS#1734) && (ODS#1734 = 2024-08-31))
      :     :     :           +- Relation[acct#1711,desc#1712,def#1713,cat#1714,grp_non_grp_cd#1715,ifrs_pack_sch_ref#1716,ifrs_pack_sch_desc#1717,ifrs_ln_item#1718,ifrs_pack_acct_nd#1719,mr_pack_sch_ref#1720,mr_line_itm#1721,mr_pack_acct_nd#1722,rtl_cube_map#1723,pri#1724,sec#1725,actvty#1726,data_prd#1727,amt_main_grp#1728,amt_sub_grp#1729,timestamp_d#1730,amt_cat#1731,fdp_is_rollover_flag#1732,fdp_last_processed_date#1733,ods#1734,... 2 more fields] parquet
      :     :     +- Project [prty_id#1737, bkg_org_val#1748, emp_cd#1750, ods_val#1752]
      :     :        +- Filter ((((((((isnotnull(STAFF_BIZ_TYPE#1745) && isnotnull(ODS_VAL#1752)) && isnotnull(PROCESS_ID_VAL#1755)) && isnotnull(PRNC_FAM_FLG#1746)) && (STAFF_BIZ_TYPE#1745 = FAM)) && (PRNC_FAM_FLG#1746 = Y)) && isnotnull(EMP_CD#1750)) && (PROCESS_ID_VAL#1755 = PRTY_EMP_RLTD-SCI-LSPEMPMAP)) && (ODS_VAL#1752 = 2024-08-31))
      :     :           +- Relation[prty_id#1737,emp_id#1738,src_sys#1739,ctry_cd#1740,strt_dt#1741,end_dt#1742,rl_type_cd#1743,role_cd#1744,staff_biz_type#1745,prnc_fam_flg#1746,ods#1747,bkg_org_val#1748,bkg_loc#1749,emp_cd#1750,emp_desc#1751,ods_val#1752,country_val#1753,tp_sys_val#1754,process_id_val#1755,frequency_val#1756,version_val#1757] parquet
      :     +- Project [prty_id#1758, ctry_cd#1760, prty_lgl_nm#1821, ods_val#1971]
      :        +- Filter (((isnotnull(PROCESS_ID_VAL#1974) && isnotnull(ODS_VAL#1971)) && (PROCESS_ID_VAL#1974 = PRTY-OTP-CUST)) && (ODS_VAL#1971 = 2024-08-31))
      :           +- Relation[prty_id#1758,src_sys#1759,ctry_cd#1760,strt_dt#1761,end_dt#1762,prty_biz_type_cd#1763,prty_cltr_pldg_rl_cd#1764,prty_inc_ctry_cd#1765,prty_cr_risk_resp_ctry_cd#1766,prty_cr_team_cd#1767,data_shr_cnst_flg#1768,file_type#1769,prty_appr_rvw_dt#1770,prty_fm_industry_cd#1771,prty_gbl_rtng_flg#1772,guaranteed_by_prnt_flg#1773,prty_hub_loc#1774,prty_ifrs_cp_type_cd#1775,prty_lang_cd#1776,prty_prnt_supt_elgt_cd#1777,prty_affl_cd#1778,prty_annl_sales_amt#1779,prty_annl_sales_amt_ccy#1780,prty_annl_income_amt#1781,... 195 more fields] parquet
      +- Project [prty_id#1977, ctry_cd#1979, prty_lgl_nm#2040, ods_val#2190]
         +- Filter (((isnotnull(PROCESS_ID_VAL#2193) && isnotnull(ODS_VAL#2190)) && (PROCESS_ID_VAL#2193 = PRTY-OTP-CUST)) && (ODS_VAL#2190 = 2024-08-31))
            +- Relation[prty_id#1977,src_sys#1978,ctry_cd#1979,strt_dt#1980,end_dt#1981,prty_biz_type_cd#1982,prty_cltr_pldg_rl_cd#1983,prty_inc_ctry_cd#1984,prty_cr_risk_resp_ctry_cd#1985,prty_cr_team_cd#1986,data_shr_cnst_flg#1987,file_type#1988,prty_appr_rvw_dt#1989,prty_fm_industry_cd#1990,prty_gbl_rtng_flg#1991,guaranteed_by_prnt_flg#1992,prty_hub_loc#1993,prty_ifrs_cp_type_cd#1994,prty_lang_cd#1995,prty_prnt_supt_elgt_cd#1996,prty_affl_cd#1997,prty_annl_sales_amt#1998,prty_annl_sales_amt_ccy#1999,prty_annl_income_amt#2000,... 195 more fields] parquet

== Physical Plan ==
HashAggregate(keys=[SUBL_ID#0, SUBL_ID_TYPE#1, TRAN_REF_NO#2, CAT_CD#3, UNIQ_ID#4, SRC_SYS#142, CTRY_CD#141, null#3233, null#3234, PRTY_ID#941, PRTY_MAIN_ID#10, RISK_PRTY_ID#11, null#3235, null#3236, CP_ID#14, SRC_RISK_PRTY_ID#15, null#3237, null#3238, null#3239, LIFCYCL_STS_CD#19, LOCAL_PRD_CD#20, STD_PRD_CD#21, BK_CD#22, TP_ENT_NM#23, ... 117 more fields], functions=[], output=[SUBL_ID#0, SUBL_ID_TYPE#1, TRAN_REF_NO#2, CAT_CD#3, UNIQ_ID#4, SRC_SYS#142, CTRY_CD#141, INSTR_ID#7, PTFOL_ID#8, PRTY_ID#941, PRTY_MAIN_ID#10, RISK_PRTY_ID#11, BKR_ID#12, CLRG_BKR_ID#13, CP_ID#14, SRC_RISK_PRTY_ID#15, SRC_BKR_ID#16, SRC_CLRG_BKR_ID#17, ACCT_STS_CD#18, LIFCYCL_STS_CD#19, LOCAL_PRD_CD#20, STD_PRD_CD#21, BK_CD#22, TP_ENT_NM#23, ... 117 more fields])
+- Exchange hashpartitioning(SUBL_ID#0, SUBL_ID_TYPE#1, TRAN_REF_NO#2, CAT_CD#3, UNIQ_ID#4, SRC_SYS#142, CTRY_CD#141, null#3233, null#3234, PRTY_ID#941, PRTY_MAIN_ID#10, RISK_PRTY_ID#11, null#3235, null#3236, CP_ID#14, SRC_RISK_PRTY_ID#15, null#3237, null#3238, null#3239, LIFCYCL_STS_CD#19, LOCAL_PRD_CD#20, STD_PRD_CD#21, BK_CD#22, TP_ENT_NM#23, ... 118 more fields)
   +- HashAggregate(keys=[SUBL_ID#0, SUBL_ID_TYPE#1, TRAN_REF_NO#2, CAT_CD#3, UNIQ_ID#4, SRC_SYS#142, CTRY_CD#141, null AS null#3233, null AS null#3234, PRTY_ID#941, PRTY_MAIN_ID#10, RISK_PRTY_ID#11, null AS null#3235, null AS null#3236, CP_ID#14, SRC_RISK_PRTY_ID#15, null AS null#3237, null AS null#3238, null AS null#3239, LIFCYCL_STS_CD#19, LOCAL_PRD_CD#20, STD_PRD_CD#21, BK_CD#22, TP_ENT_NM#23, ... 117 more fields], functions=[], output=[SUBL_ID#0, SUBL_ID_TYPE#1, TRAN_REF_NO#2, CAT_CD#3, UNIQ_ID#4, SRC_SYS#142, CTRY_CD#141, null#3233, null#3234, PRTY_ID#941, PRTY_MAIN_ID#10, RISK_PRTY_ID#11, null#3235, null#3236, CP_ID#14, SRC_RISK_PRTY_ID#15, null#3237, null#3238, null#3239, LIFCYCL_STS_CD#19, LOCAL_PRD_CD#20, STD_PRD_CD#21, BK_CD#22, TP_ENT_NM#23, ... 117 more fields])
      +- Project [SUBL_ID#145 AS SUBL_ID#0, SUBL_ID_TYPE#155 AS SUBL_ID_TYPE#1, CASE WHEN ((substring(ACCT_ID#245, -2, 2147483647) = +C) && (GL_AMT_TYPE#160 = BANL)) THEN ACCT_ID#245 WHEN ((substring(ACCT_ID#245, -2, 2147483647) = +I) && (GL_AMT_TYPE#160 = IPIA)) THEN ACCT_ID#245 WHEN ((substring(ACCT_ID#245, -2, 2147483647) = +R) && (GL_AMT_TYPE#160 = RPIP)) THEN ACCT_ID#245 ELSE ACCT_ID#245 END AS TRAN_REF_NO#2, CASE WHEN isnotnull(ACCT_ID#245) THEN ACCT ELSE NA END AS CAT_CD#3, UNIQ_ID#183 AS UNIQ_ID#4, SRC_SYS#142, CTRY_CD#141, PRTY_ID#941, PRTY_ID#722 AS PRTY_MAIN_ID#10, PRTY_ID#1379 AS RISK_PRTY_ID#11, CP_ID#287 AS CP_ID#14, RISK_PRTY_ID#403 AS SRC_RISK_PRTY_ID#15, LIFCYCL_STS_CD#371 AS LIFCYCL_STS_CD#19, LOCAL_PRD_CD#375 AS LOCAL_PRD_CD#20, STD_PRD_CD#411 AS STD_PRD_CD#21, BK_CD#283 AS BK_CD#22, TP_ENT_NM#418 AS TP_ENT_NM#23, LGL_ENT_CD#179, SCI_ENTITY_CODE#1604 AS BKG_LOC_CD#25, LN_EFF_DT#373 AS ADJ_VAL_DT_1#26, FST_LN_DRWDOWN_DT#330 AS TRD_DT#27, MATURITY_DT#377, SETLM_DT#409, ACCT_REF_ID#579 AS CONTR_ID#33, ... 96 more fields]
         +- BroadcastHashJoin [RISK_PRTY_ID#403, ODS_VAL#224, CTRY_CD#141], [PRTY_ID#1977, ODS_VAL#2190, CTRY_CD#1979], LeftOuter, BuildRight
            :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 93 more fields]
            :  +- BroadcastHashJoin [CP_ID#287, ODS_VAL#224, CTRY_CD#141], [PRTY_ID#1758, ODS_VAL#1971, CTRY_CD#1760], LeftOuter, BuildRight
            :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 92 more fields]
            :     :  +- BroadcastHashJoin [PRTY_ID#941, SCI_ENTITY_CODE#1604, ODS_VAL#1154], [PRTY_ID#1737, BKG_ORG_VAL#1748, ODS_VAL#1752], LeftOuter, BuildRight
            :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 92 more fields]
            :     :     :  +- BroadcastHashJoin [GL_ACCT_CD#149], [ACCT#1711], LeftOuter, BuildRight
            :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 92 more fields]
            :     :     :     :  +- BroadcastHashJoin [SRC_SYS#142, ODS_VAL#224], [DERIVED_ADM_TP_SOURCE#1702, ODS#1708], LeftOuter, BuildRight
            :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 91 more fields]
            :     :     :     :     :  +- BroadcastHashJoin [GL_ACCT_CD#149, GL_BIZ_UNIT_CD#148, GL_PRD_CD#154, GL_DEPT_CD#150, ODS_VAL#224], [PSGLACCOUNTFROM#1675, PSGLBU#1674, PSGLPRODUCTFROM#1677, PSGLDEPTFROM#1679, ODS#1689], LeftOuter, BuildRight
            :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 90 more fields]
            :     :     :     :     :     :  +- Filter isnull(CHRT_FLD_ID#1647)
            :     :     :     :     :     :     +- BroadcastHashJoin [GL_ACCT_CD#149, ODS_VAL#224], [CHRT_FLD_ID#1647, ODS_VAL#1668], LeftOuter, BuildRight
            :     :     :     :     :     :        :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 84 more fields]
            :     :     :     :     :     :        :  +- BroadcastHashJoin [GL_CUST_CLAS_CD#152, ODS_VAL#224], [CHRT_FLD_ID#1616, ODS_VAL#1637], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 83 more fields]
            :     :     :     :     :     :        :     :  +- BroadcastHashJoin [CASE WHEN (length(ACCT_REF_ID#579) = 12) THEN substring(ACCT_REF_ID#579, 1, 3) ELSE substring(ACCT_REF_ID#579, 3, 3) END, CTRY_CD#141, cast(ODS#181 as string)], [branch_code#1600, country_code#1599, ODS#1609], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 83 more fields]
            :     :     :     :     :     :        :     :     :  +- BroadcastHashJoin [PRTY_ID#706, ODS_VAL#716], [PRTY_ID#1379, ODS_VAL#1592], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 84 more fields]
            :     :     :     :     :     :        :     :     :     :  +- BroadcastHashJoin [PRTY_RL_ID#707, ODS_VAL#716], [PRTY_ID#1160, ODS_VAL#1373], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 84 more fields]
            :     :     :     :     :     :        :     :     :     :     :  +- BroadcastHashJoin [PRTY_ID#690, ODS_VAL#700], [PRTY_ID#941, ODS_VAL#1154], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 83 more fields]
            :     :     :     :     :     :        :     :     :     :     :     :  +- BroadcastHashJoin [PRTY_RL_ID#691, ODS_VAL#700], [PRTY_ID#722, ODS_VAL#935], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 83 more fields]
            :     :     :     :     :     :        :     :     :     :     :     :     :  +- BroadcastHashJoin [PRTY_ID#674, ODS_VAL#684], [PRTY_ID#706, ODS_VAL#716], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 82 more fields]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :  +- BroadcastHashJoin [PRTY_ID#657, ODS_VAL#667], [PRTY_ID#690, ODS_VAL#700], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 81 more fields]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ACCT_ID#245, ODS_VAL#650, TP_SYS_VAL#652, SRC_SYS#250, country_val#651], [ACCT_ID#673, ODS_VAL#684, TP_SYS_VAL#686, SRC_SYS#675, country_val#685], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 83 more fields]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ACCT_ID#245, ODS_VAL#650, TP_SYS_VAL#652, SRC_SYS#250, country_val#651], [ACCT_ID#656, ODS_VAL#667, TP_SYS_VAL#669, SRC_SYS#658, country_val#668], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :- Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 81 more fields]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :  +- BroadcastHashJoin [ACCT_ID#231, country_val#240, ODS_VAL#239, TP_SYS_VAL#241], [ACCT_ID#245, country_val#651, ODS_VAL#650, TP_SYS_VAL#652], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :- *(2) Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 37 more fields]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :  +- *(2) BroadcastHashJoin [SUBL_ID#145, ODS_VAL#224, country_val#225], [SUBL_ID#230, ODS_VAL#239, country_val#240], LeftOuter, BuildRight
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :     :- *(2) Project [ctry_cd#141, src_sys#142, strt_dt#143, end_dt#144, subl_id#145, tran_ccy#147, gl_biz_unit_cd#148, gl_acct_cd#149, gl_dept_cd#150, gl_affl_cd#151, gl_cust_clas_cd#152, gl_op_unit_cd#153, gl_prd_cd#154, subl_id_type#155, acct_cat_nm#156, acct_sub_cat_nm#157, local_ccy#158, bal_amt#159, gl_amt_type#160, coa_acct_clas#161, ifrs_sched#162, intco_flg#163, ecl_expsr_flg#164, subl_acct#167, ... 34 more fields]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :     :  +- *(2) Filter (((isnotnull(GL_ACCT_CD#149) && isnotnull(SRC_SYS#142)) && (SRC_SYS#142 = OTP)) && NOT StartsWith(GL_ACCT_CD#149, 9))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :     :     +- *(2) FileScan parquet fdp_daas_uat.sub_ldgr[ctry_cd#141,src_sys#142,strt_dt#143,end_dt#144,subl_id#145,tran_ccy#147,gl_biz_unit_cd#148,gl_acct_cd#149,gl_dept_cd#150,gl_affl_cd#151,gl_cust_clas_cd#152,gl_op_unit_cd#153,gl_prd_cd#154,subl_id_type#155,acct_cat_nm#156,acct_sub_cat_nm#157,local_ccy#158,bal_amt#159,gl_amt_type#160,coa_acct_clas#161,ifrs_sched#162,intco_flg#163,ecl_expsr_flg#164,subl_acct#167,... 38 more fields] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit/fdp/bank/hdata/fdp_uat/fdp_d..., PartitionCount: 15, PartitionFilters: [isnotnull(process_id_val#227), isnotnull(ods_val#224), isnotnull(tp_sys_val#226), (ods_val#224 =..., PushedFilters: [IsNotNull(gl_acct_cd), IsNotNull(src_sys), EqualTo(src_sys,OTP), Not(StringStartsWith(gl_acct_cd..., ReadSchema: struct<ctry_cd:string,src_sys:string,strt_dt:date,end_dt:date,subl_id:string,tran_ccy:string,gl_b...
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[2, string, true], input[3, string, true]))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :        +- *(1) Project [subl_id#230, acct_id#231, ods_val#239, country_val#240, tp_sys_val#241]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :           +- *(1) Filter (((isnotnull(RL_TYPE_CD#236) && isnotnull(SRC_SYS#232)) && (SRC_SYS#232 = OTP)) && (RL_TYPE_CD#236 = SubLedgerToAccount))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     :              +- *(1) FileScan parquet fdp_daas_uat.sub_ldgr_acct_rltd[subl_id#230,acct_id#231,src_sys#232,rl_type_cd#236,ods_val#239,country_val#240,tp_sys_val#241,process_id_val#242,frequency_val#243,version_val#244] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit/fdp/bank/hdata/fdp_uat/fdp_d..., PartitionCount: 15, PartitionFilters: [isnotnull(tp_sys_val#241), isnotnull(ods_val#239), isnotnull(process_id_val#242), (tp_sys_val#24..., PushedFilters: [IsNotNull(rl_type_cd), IsNotNull(src_sys), EqualTo(src_sys,OTP), EqualTo(rl_type_cd,SubLedgerToA..., ReadSchema: struct<subl_id:string,acct_id:string,src_sys:string,rl_type_cd:string>
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[46, string, true], input[45, string, true], input[47, string, true]))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :        +- *(3) Project [acct_id#245, src_sys#250, acct_clse_dt#252, acct_open_dt#264, acct_open_br_cd#265, bk_cd#283, cp_id#287, cust_mrgn_rt#304, day_cnt_conv_cd#308, disapproved_period#327, fac_orig_loc#328, fst_ln_drwdown_dt#330, int_rt#353, int_rt_type#355, lifcycl_sts_cd#371, ln_eff_dt#373, local_prd_cd#375, maturity_dt#377, obl_flg#384, recrse_flg#401, risk_prty_id#403, sel_down_flg#408, setlm_dt#409, std_prd_cd#411, ... 24 more fields]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :           +- *(3) Filter (isnotnull(SRC_SYS#250) && (SRC_SYS#250 = OTP))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     :              +- *(3) FileScan parquet fdp_daas_uat.acct[acct_id#245,src_sys#250,acct_clse_dt#252,acct_open_dt#264,acct_open_br_cd#265,bk_cd#283,cp_id#287,cust_mrgn_rt#304,day_cnt_conv_cd#308,disapproved_period#327,fac_orig_loc#328,fst_ln_drwdown_dt#330,int_rt#353,int_rt_type#355,lifcycl_sts_cd#371,ln_eff_dt#373,local_prd_cd#375,maturity_dt#377,obl_flg#384,recrse_flg#401,risk_prty_id#403,sel_down_flg#408,setlm_dt#409,std_prd_cd#411,... 27 more fields] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit/fdp/bank/hdata/fdp_uat/fdp_d..., PartitionCount: 35, PartitionFilters: [isnotnull(ods_val#650), isnotnull(process_id_val#653), (process_id_val#653 = ACCT-OTP-TRDSTATIC)..., PushedFilters: [IsNotNull(src_sys), EqualTo(src_sys,OTP)], ReadSchema: struct<acct_id:string,src_sys:string,acct_clse_dt:date,acct_open_dt:date,acct_open_br_cd:string,b...
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[3, string, true], input[5, string, true], input[2, string, true], input[4, string, true]))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :        +- *(4) Project [acct_id#656, prty_id#657, src_sys#658, ods_val#667, country_val#668, tp_sys_val#669]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :           +- *(4) Filter (isnotnull(RL_TYPE_CD#662) && (RL_TYPE_CD#662 = TPCustomertoSubprofile))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     :              +- *(4) FileScan parquet fdp_daas_uat.prty_acct_rltd[acct_id#656,prty_id#657,src_sys#658,rl_type_cd#662,ods_val#667,country_val#668,tp_sys_val#669,process_id_val#670,frequency_val#671,version_val#672] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit/fdp/bank/hdata/fdp_uat/fdp_d..., PartitionCount: 35, PartitionFilters: [isnotnull(ods_val#667), isnotnull(process_id_val#670), (ods_val#667 = 2024-08-31), (process_id_v..., PushedFilters: [IsNotNull(rl_type_cd), EqualTo(rl_type_cd,TPCustomertoSubprofile)], ReadSchema: struct<acct_id:string,prty_id:string,src_sys:string,rl_type_cd:string>
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[3, string, true], input[5, string, true], input[2, string, true], input[4, string, true]))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :        +- *(5) Project [acct_id#673, prty_id#674, src_sys#675, ods_val#684, country_val#685, tp_sys_val#686]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :           +- *(5) Filter (isnotnull(RL_TYPE_CD#679) && (RL_TYPE_CD#679 = RiskPartytoSubprofile))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     :              +- *(5) FileScan parquet fdp_daas_uat.prty_acct_rltd[acct_id#673,prty_id#674,src_sys#675,rl_type_cd#679,ods_val#684,country_val#685,tp_sys_val#686,process_id_val#687,frequency_val#688,version_val#689] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit/fdp/bank/hdata/fdp_uat/fdp_d..., PartitionCount: 33, PartitionFilters: [isnotnull(process_id_val#687), isnotnull(ods_val#684), (ods_val#684 = 2024-08-31), (process_id_v..., PushedFilters: [IsNotNull(rl_type_cd), EqualTo(rl_type_cd,RiskPartytoSubprofile)], ReadSchema: struct<acct_id:string,prty_id:string,src_sys:string,rl_type_cd:string>
            :     :     :     :     :     :        :     :     :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[2, string, true]))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :        +- *(6) Project [prty_id#690, prty_rl_id#691, ods_val#700]
            :     :     :     :     :     :        :     :     :     :     :     :     :     :           +- *(6) Filter (((isnotnull(RL_TYPE_CD#697) && isnotnull(SRC_SYS#692)) && (SRC_SYS#692 = SCI)) && (RL_TYPE_CD#697 = SubProfileToMainProfile))
            :     :     :     :     :     :        :     :     :     :     :     :     :     :              +- *(6) FileScan parquet fdp_daas_uat.prty_rltd[prty_id#690,prty_rl_id#691,src_sys#692,rl_type_cd#697,ods_val#700,country_val#701,tp_sys_val#702,process_id_val#703,frequency_val#704,version_val#705] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit_enc/fdp/bank/hdata/fdp_uat/f..., PartitionCount: 1, PartitionFilters: [isnotnull(process_id_val#703), isnotnull(ods_val#700), (ods_val#700 = 2024-08-31), (process_id_v..., PushedFilters: [IsNotNull(rl_type_cd), IsNotNull(src_sys), EqualTo(src_sys,SCI), EqualTo(rl_type_cd,SubProfileTo..., ReadSchema: struct<prty_id:string,prty_rl_id:string,src_sys:string,rl_type_cd:string>
            :     :     :     :     :     :        :     :     :     :     :     :     :     +- ReusedExchange [prty_id#706, prty_rl_id#707, ods_val#716], BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[2, string, true]))
            :     :     :     :     :     :        :     :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[1, string, true]))
            :     :     :     :     :     :        :     :     :     :     :     :        +- *(8) Project [prty_id#722, ods_val#935]
            :     :     :     :     :     :        :     :     :     :     :     :           +- *(8) Filter (((isnotnull(PRTY_CAT_CD#754) && isnotnull(SRC_SYS#723)) && (SRC_SYS#723 = SCI)) && (PRTY_CAT_CD#754 = MainProfile))
            :     :     :     :     :     :        :     :     :     :     :     :              +- *(8) FileScan parquet fdp_daas_uat.prty[prty_id#722,src_sys#723,prty_cat_cd#754,ods_val#935,country_val#936,tp_sys_val#937,process_id_val#938,frequency_val#939,version_val#940] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit_enc/fdp/bank/hdata/fdp_uat/f..., PartitionCount: 1, PartitionFilters: [isnotnull(process_id_val#938), isnotnull(ods_val#935), (ods_val#935 = 2024-08-31), (process_id_v..., PushedFilters: [IsNotNull(prty_cat_cd), IsNotNull(src_sys), EqualTo(src_sys,SCI), EqualTo(prty_cat_cd,MainProfile)], ReadSchema: struct<prty_id:string,src_sys:string,prty_cat_cd:string>
            :     :     :     :     :     :        :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[2, string, true]))
            :     :     :     :     :     :        :     :     :     :     :        +- *(9) Project [prty_id#941, prty_ifrs_cp_type_cd#958, ods_val#1154]
            :     :     :     :     :     :        :     :     :     :     :           +- *(9) Filter (((isnotnull(PRTY_CAT_CD#973) && isnotnull(SRC_SYS#942)) && (SRC_SYS#942 = SCI)) && (PRTY_CAT_CD#973 = SubProfile))
            :     :     :     :     :     :        :     :     :     :     :              +- *(9) FileScan parquet fdp_daas_uat.prty[prty_id#941,src_sys#942,prty_ifrs_cp_type_cd#958,prty_cat_cd#973,ods_val#1154,country_val#1155,tp_sys_val#1156,process_id_val#1157,frequency_val#1158,version_val#1159] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit_enc/fdp/bank/hdata/fdp_uat/f..., PartitionCount: 1, PartitionFilters: [isnotnull(ods_val#1154), isnotnull(process_id_val#1157), (ods_val#1154 = 2024-08-31), (process_i..., PushedFilters: [IsNotNull(prty_cat_cd), IsNotNull(src_sys), EqualTo(src_sys,SCI), EqualTo(prty_cat_cd,SubProfile)], ReadSchema: struct<prty_id:string,src_sys:string,prty_ifrs_cp_type_cd:string,prty_cat_cd:string>
            :     :     :     :     :     :        :     :     :     :     +- ReusedExchange [prty_id#1160, ods_val#1373], BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[1, string, true]))
            :     :     :     :     :     :        :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[1, string, true]))
            :     :     :     :     :     :        :     :     :        +- *(11) Project [prty_id#1379, ods_val#1592]
            :     :     :     :     :     :        :     :     :           +- *(11) Filter (((isnotnull(SRC_SYS#1380) && isnotnull(PRTY_CAT_CD#1411)) && (SRC_SYS#1380 = SCI)) && (PRTY_CAT_CD#1411 = SubProfile))
            :     :     :     :     :     :        :     :     :              +- *(11) FileScan parquet fdp_daas_uat.prty[prty_id#1379,src_sys#1380,prty_cat_cd#1411,ods_val#1592,country_val#1593,tp_sys_val#1594,process_id_val#1595,frequency_val#1596,version_val#1597] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit_enc/fdp/bank/hdata/fdp_uat/f..., PartitionCount: 1, PartitionFilters: [isnotnull(ods_val#1592), isnotnull(process_id_val#1595), (ods_val#1592 = 2024-08-31), (process_i..., PushedFilters: [IsNotNull(src_sys), IsNotNull(prty_cat_cd), EqualTo(src_sys,SCI), EqualTo(prty_cat_cd,SubProfile)], ReadSchema: struct<prty_id:string,src_sys:string,prty_cat_cd:string>
            :     :     :     :     :     :        :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[1, string, true], input[0, string, true], input[3, string, true]))
            :     :     :     :     :     :        :     :        +- *(12) Project [country_code#1599, branch_code#1600, sci_entity_code#1604, ods#1609]
            :     :     :     :     :     :        :     :           +- *(12) Filter (isnotnull(tp_system#1598) && (tp_system#1598 = OTP))
            :     :     :     :     :     :        :     :              +- *(12) FileScan parquet fdp_mfu_staging_dev.m_scb_entity_xlate[tp_system#1598,country_code#1599,branch_code#1600,sci_entity_code#1604,ods#1609,country#1610,tp_sys#1611] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit/fdp/bank/hdata/fdp_dev/fdp_m..., PartitionCount: 1, PartitionFilters: [isnotnull(ods#1609), (ods#1609 = 2024-08-31)], PushedFilters: [IsNotNull(tp_system), EqualTo(tp_system,OTP)], ReadSchema: struct<tp_system:string,country_code:string,branch_code:string,sci_entity_code:string>
            :     :     :     :     :     :        :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[2, string, true]))
            :     :     :     :     :     :        :        +- *(13) Project [chrt_fld_id#1616, chrt_fld_lvl_0#1626, ods_val#1637]
            :     :     :     :     :     :        :           +- *(13) Filter (((isnotnull(CHRT_FLD_TYPE_CD#1621) && isnotnull(SRC_SYS#1612)) && (SRC_SYS#1612 = RDM)) && (CHRT_FLD_TYPE_CD#1621 = CustomerClass))
            :     :     :     :     :     :        :              +- *(13) FileScan parquet fdp_daas_uat.chrt_of_acct[src_sys#1612,chrt_fld_id#1616,chrt_fld_type_cd#1621,chrt_fld_lvl_0#1626,ods_val#1637,country_val#1638,tp_sys_val#1639,process_id_val#1640,frequency_val#1641,version_val#1642] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit_enc/fdp/bank/hdata/fdp_uat/f..., PartitionCount: 4, PartitionFilters: [isnotnull(ods_val#1637), (ods_val#1637 = 2024-08-31)], PushedFilters: [IsNotNull(chrt_fld_type_cd), IsNotNull(src_sys), EqualTo(src_sys,RDM), EqualTo(chrt_fld_type_cd,..., ReadSchema: struct<src_sys:string,chrt_fld_id:string,chrt_fld_type_cd:string,chrt_fld_lvl_0:string>
            :     :     :     :     :     :        +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[7, string, true]))
            :     :     :     :     :     :           +- *(15) HashAggregate(keys=[CHRT_FLD_ID#1647, DESC#1650, CHRT_FLD_CAT_CD#1654, SRC_SYS#1643, CHRT_FLD_TYPE_CD#1652, PGC_IFRSS_SCH#1663, PGC_IFRSS_SCH_DESC#1664, PGC_GRP_NONGRP#1665, PGC_MR_SCH_REF#1666, ODS_VAL#1668], functions=[], output=[CHRT_FLD_ID#1647, DESC#1650, CHRT_FLD_CAT_CD#1654, PGC_IFRSS_SCH#1663, PGC_IFRSS_SCH_DESC#1664, PGC_GRP_NONGRP#1665, PGC_MR_SCH_REF#1666, ODS_VAL#1668])
            :     :     :     :     :     :              +- Exchange hashpartitioning(CHRT_FLD_ID#1647, DESC#1650, CHRT_FLD_CAT_CD#1654, SRC_SYS#1643, CHRT_FLD_TYPE_CD#1652, PGC_IFRSS_SCH#1663, PGC_IFRSS_SCH_DESC#1664, PGC_GRP_NONGRP#1665, PGC_MR_SCH_REF#1666, ODS_VAL#1668, 200)
            :     :     :     :     :     :                 +- *(14) HashAggregate(keys=[CHRT_FLD_ID#1647, DESC#1650, CHRT_FLD_CAT_CD#1654, SRC_SYS#1643, CHRT_FLD_TYPE_CD#1652, PGC_IFRSS_SCH#1663, PGC_IFRSS_SCH_DESC#1664, PGC_GRP_NONGRP#1665, PGC_MR_SCH_REF#1666, ODS_VAL#1668], functions=[], output=[CHRT_FLD_ID#1647, DESC#1650, CHRT_FLD_CAT_CD#1654, SRC_SYS#1643, CHRT_FLD_TYPE_CD#1652, PGC_IFRSS_SCH#1663, PGC_IFRSS_SCH_DESC#1664, PGC_GRP_NONGRP#1665, PGC_MR_SCH_REF#1666, ODS_VAL#1668])
            :     :     :     :     :     :                    +- *(14) Project [CHRT_FLD_ID#1647, DESC#1650, CHRT_FLD_CAT_CD#1654, SRC_SYS#1643, CHRT_FLD_TYPE_CD#1652, PGC_IFRSS_SCH#1663, PGC_IFRSS_SCH_DESC#1664, PGC_GRP_NONGRP#1665, PGC_MR_SCH_REF#1666, ODS_VAL#1668]
            :     :     :     :     :     :                       +- *(14) Filter (((((isnotnull(CHRT_FLD_TYPE_CD#1652) && isnotnull(CHRT_FLD_CAT_CD#1654)) && isnotnull(SRC_SYS#1643)) && Contains(CHRT_FLD_CAT_CD#1654, P/L)) && (SRC_SYS#1643 = RDM)) && (CHRT_FLD_TYPE_CD#1652 = Account))
            :     :     :     :     :     :                          +- *(14) FileScan parquet fdp_daas_uat.chrt_of_acct[src_sys#1643,chrt_fld_id#1647,desc#1650,chrt_fld_type_cd#1652,chrt_fld_cat_cd#1654,pgc_ifrss_sch#1663,pgc_ifrss_sch_desc#1664,pgc_grp_nongrp#1665,pgc_mr_sch_ref#1666,ods_val#1668,country_val#1669,tp_sys_val#1670,process_id_val#1671,frequency_val#1672,version_val#1673] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit_enc/fdp/bank/hdata/fdp_uat/f..., PartitionCount: 4, PartitionFilters: [isnotnull(ods_val#1668), (ods_val#1668 = 2024-08-31)], PushedFilters: [IsNotNull(chrt_fld_type_cd), IsNotNull(chrt_fld_cat_cd), IsNotNull(src_sys), StringContains(chrt..., ReadSchema: struct<src_sys:string,chrt_fld_id:string,desc:string,chrt_fld_type_cd:string,chrt_fld_cat_cd:stri...
            :     :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[1, string, true], input[0, string, true], input[2, string, true], input[3, string, true], input[5, string, true]))
            :     :     :     :     :        +- *(16) Project [psglbu#1674, psglaccountfrom#1675, psglproductfrom#1677, psgldeptfrom#1679, accountingclassification#1682, ods#1689]
            :     :     :     :     :           +- *(16) FileScan parquet fdp_mfu_staging_dev.m_ifrs9_acct_class_xlate[psglbu#1674,psglaccountfrom#1675,psglproductfrom#1677,psgldeptfrom#1679,accountingclassification#1682,ods#1689,country#1690,tp_sys#1691] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[], PartitionCount: 0, PartitionFilters: [isnotnull(ods#1689), (ods#1689 = 2024-08-31)], PushedFilters: [], ReadSchema: struct<psglbu:string,psglaccountfrom:string,psglproductfrom:string,psgldeptfrom:string,accounting...
            :     :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[2, string, true]))
            :     :     :     :        +- *(18) HashAggregate(keys=[derived_adm_tp_source#1702, derived_adm_jrnl_src#1703, ods#1708], functions=[], output=[derived_adm_tp_source#1702, derived_adm_jrnl_src#1703, ods#1708])
            :     :     :     :           +- Exchange hashpartitioning(derived_adm_tp_source#1702, derived_adm_jrnl_src#1703, ods#1708, 200)
            :     :     :     :              +- *(17) HashAggregate(keys=[derived_adm_tp_source#1702, derived_adm_jrnl_src#1703, ods#1708], functions=[], output=[derived_adm_tp_source#1702, derived_adm_jrnl_src#1703, ods#1708])
            :     :     :     :                 +- *(17) Project [derived_adm_tp_source#1702, derived_adm_jrnl_src#1703, ods#1708]
            :     :     :     :                    +- *(17) FileScan parquet fdp_mfu_staging_dev.m_psgl_src_lsdr_src_sys_xlate[derived_adm_tp_source#1702,derived_adm_jrnl_src#1703,ods#1708,country#1709,tp_sys#1710] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[], PartitionCount: 0, PartitionFilters: [isnotnull(ods#1708), (ods#1708 = 2024-08-31)], PushedFilters: [], ReadSchema: struct<derived_adm_tp_source:string,derived_adm_jrnl_src:string>
            :     :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true]))
            :     :     :        +- *(19) Project [acct#1711]
            :     :     :           +- *(19) FileScan parquet fdp_mfu_staging_dev.m_gl_acct_amt_grp[acct#1711,ods#1734,country#1735,tp_sys#1736] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[], PartitionCount: 0, PartitionFilters: [isnotnull(ods#1734), (ods#1734 = 2024-08-31)], PushedFilters: [], ReadSchema: struct<acct:string>
            :     :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[1, string, true], input[3, string, true]))
            :     :        +- *(20) Project [prty_id#1737, bkg_org_val#1748, emp_cd#1750, ods_val#1752]
            :     :           +- *(20) Filter ((((isnotnull(STAFF_BIZ_TYPE#1745) && isnotnull(PRNC_FAM_FLG#1746)) && (STAFF_BIZ_TYPE#1745 = FAM)) && (PRNC_FAM_FLG#1746 = Y)) && isnotnull(EMP_CD#1750))
            :     :              +- *(20) FileScan parquet fdp_daas_uat.prty_emp_rltd[prty_id#1737,staff_biz_type#1745,prnc_fam_flg#1746,bkg_org_val#1748,emp_cd#1750,ods_val#1752,country_val#1753,tp_sys_val#1754,process_id_val#1755,frequency_val#1756,version_val#1757] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit_enc/fdp/bank/hdata/fdp_uat/f..., PartitionCount: 1, PartitionFilters: [isnotnull(ods_val#1752), isnotnull(process_id_val#1755), (process_id_val#1755 = PRTY_EMP_RLTD-SC..., PushedFilters: [IsNotNull(staff_biz_type), IsNotNull(prnc_fam_flg), EqualTo(staff_biz_type,FAM), EqualTo(prnc_fa..., ReadSchema: struct<prty_id:string,staff_biz_type:string,prnc_fam_flg:string,bkg_org_val:string,emp_cd:string>
            :     +- BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[3, string, true], input[1, string, true]))
            :        +- *(21) Project [prty_id#1758, ctry_cd#1760, prty_lgl_nm#1821, ods_val#1971]
            :           +- *(21) FileScan parquet fdp_daas_uat.prty[prty_id#1758,ctry_cd#1760,prty_lgl_nm#1821,ods_val#1971,country_val#1972,tp_sys_val#1973,process_id_val#1974,frequency_val#1975,version_val#1976] Batched: true, Format: Parquet, Location: PrunedInMemoryFileIndex[hdfs://haasbatchtest.hbtscb.dev.net:8020/sit/fdp/bank/hdata/fdp_uat/fdp_d..., PartitionCount: 41, PartitionFilters: [isnotnull(process_id_val#1974), isnotnull(ods_val#1971), (process_id_val#1974 = PRTY-OTP-CUST), ..., PushedFilters: [], ReadSchema: struct<prty_id:string,ctry_cd:string,prty_lgl_nm:string>
            +- ReusedExchange [prty_id#1977, ctry_cd#1979, prty_lgl_nm#2040, ods_val#2190], BroadcastExchange HashedRelationBroadcastMode(List(input[0, string, true], input[3, string, true], input[1, string, true]))
